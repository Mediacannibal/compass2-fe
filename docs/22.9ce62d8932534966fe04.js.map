{"version":3,"sources":["webpack:///./node_modules/tiny-warning/dist/tiny-warning.esm.js","webpack:///./src/assets/Clean Walk/Video/VID_next.png","webpack:///./src/assets/Clean Walk/google.svg","webpack:///./src/assets/Clean Walk/facebook.svg","webpack:///./src/assets/images/Levels_Screen/share icon.svg","webpack:///./src/assets/images/Levels_Screen/settings icon.svg","webpack:///./src/assets/Clean Walk/instagram.png","webpack:///./src/assets/Clean Walk/Audio_icon_ON.png","webpack:///./src/assets/Clean Walk/Audio_icon.png","webpack:///./src/assets/Clean Walk/Vibration Icon_ON.png","webpack:///./src/assets/Clean Walk/Vibration Icon.png","webpack:///./src/assets/Clean Walk/clear.png","webpack:///./src/assets/Clean Walk/csv.svg","webpack:///./src/assets/Clean Walk/download.svg","webpack:///./src/assets/Clean Walk/reload.svg","webpack:///./src/assets/Clean Walk/Levels_Screen/BG_top.svg","webpack:///./src/assets/images/Game_Main_Screen/tick 1.png","webpack:///./src/assets/images/Game_Main_Screen/arrow.png","webpack:///./src/assets/Clean Walk/Loading_Screen/LD_DULT_Logo.png","webpack:///./src/assets/images/Levels_Screen/LS_qr.png","webpack:///./src/assets/lock.svg","webpack:///./src/assets/Clean Walk/Clues/Clue_lev_01.png","webpack:///./src/assets/Clean Walk/Clues/Clue_lev_02.png","webpack:///./src/assets/Clean Walk/Clues/Clue_lev_03.png","webpack:///./src/assets/Clean Walk/Clues/Clue_lev_06.png","webpack:///./src/assets/Clean Walk/Clues/Clue_lev_05.png","webpack:///./src/assets/Clean Walk/Clues/Clue_lev_04.png","webpack:///./src/assets/Clean Walk/Clues/Clue_lev_07.png","webpack:///./src/assets/Clean Walk/Clues/Clue_lev_08.png","webpack:///./src/assets/Clean Walk/Clues/Clue_lev_09.png","webpack:///./src/assets/Clean Walk/close.png","webpack:///./src/assets/images/Video/VID_bg.jpg","webpack:///./src/assets/Clean Walk/rotate.svg","webpack:///./src/assets/Clean Walk/camer_icon.png","webpack:///./src/assets/down.png","webpack:///./src/assets/up.png","webpack:///./src/assets/eye-visibility.svg","webpack:///./src/assets/eye-invisible.svg","webpack:///./src/assets/close_icon.svg","webpack:///./node_modules/webrtc-adapter/src/js/utils.js","webpack:///./node_modules/webrtc-adapter/src/js/chrome/getusermedia.js","webpack:///./node_modules/webrtc-adapter/src/js/chrome/getdisplaymedia.js","webpack:///./node_modules/webrtc-adapter/src/js/chrome/chrome_shim.js","webpack:///./node_modules/webrtc-adapter/src/js/edge/getusermedia.js","webpack:///./node_modules/webrtc-adapter/src/js/edge/getdisplaymedia.js","webpack:///./node_modules/webrtc-adapter/src/js/edge/edge_shim.js","webpack:///./node_modules/webrtc-adapter/src/js/edge/filtericeservers.js","webpack:///./node_modules/webrtc-adapter/src/js/firefox/getusermedia.js","webpack:///./node_modules/webrtc-adapter/src/js/firefox/getdisplaymedia.js","webpack:///./node_modules/webrtc-adapter/src/js/firefox/firefox_shim.js","webpack:///./node_modules/webrtc-adapter/src/js/safari/safari_shim.js","webpack:///./node_modules/webrtc-adapter/src/js/common_shim.js","webpack:///./node_modules/webrtc-adapter/src/js/adapter_core.js","webpack:///./node_modules/webrtc-adapter/src/js/adapter_factory.js"],"names":["condition","message","module","exports","logDisabled_","deprecationWarnings_","extractVersion","uastring","expr","pos","match","length","parseInt","wrapPeerConnectionEvent","window","eventNameToWrap","wrapper","RTCPeerConnection","proto","prototype","nativeAddEventListener","addEventListener","nativeEventName","cb","apply","this","arguments","wrappedCallback","e","modifiedEvent","handleEvent","_eventMap","Map","set","nativeRemoveEventListener","removeEventListener","has","unwrappedCb","get","delete","size","Object","keys","defineProperty","enumerable","configurable","disableLog","bool","Error","disableWarnings","log","console","deprecated","oldMethod","newMethod","warn","isObject","val","toString","call","compactObject","data","reduce","accumulator","key","isObj","value","isEmptyObject","undefined","assign","filterStats","result","track","outbound","streamStatsType","filteredResult","trackStats","forEach","type","trackIdentifier","id","push","trackStat","stats","trackId","walkStats","base","resultSet","name","endsWith","shimGetUserMedia","browserDetails","navigator","mediaDevices","constraintsToChrome_","c","mandatory","optional","cc","r","ideal","exact","min","max","oldname_","prefix","charAt","toUpperCase","slice","oc","mix","advanced","concat","shimConstraints_","constraints","func","version","JSON","parse","stringify","audio","remap","obj","a","b","video","face","facingMode","getSupportedFacingModeLies","getSupportedConstraints","matches","enumerateDevices","then","devices","dev","filter","d","kind","find","some","label","toLowerCase","includes","deviceId","shimError_","PermissionDeniedError","PermissionDismissedError","InvalidStateError","DevicesNotFoundError","ConstraintNotSatisfiedError","TrackStartError","MediaDeviceFailedDueToShutdown","MediaDeviceKillSwitchOn","TabCaptureError","ScreenCaptureError","DeviceCaptureError","constraint","constraintName","getUserMedia","onSuccess","onError","webkitGetUserMedia","bind","origGetUserMedia","cs","stream","getAudioTracks","getVideoTracks","getTracks","stop","DOMException","Promise","reject","shimGetDisplayMedia","getSourceId","getDisplayMedia","sourceId","widthSpecified","width","heightSpecified","height","frameRateSpecified","frameRate","chromeMediaSource","chromeMediaSourceId","maxFrameRate","maxWidth","maxHeight","error","shimMediaStream","MediaStream","webkitMediaStream","shimOnTrack","_ontrack","f","origSetRemoteDescription","setRemoteDescription","_ontrackpoly","te","receiver","getReceivers","event","Event","transceiver","streams","dispatchEvent","shimGetSendersWithDtmf","shimSenderWithDtmf","pc","_dtmf","createDTMFSender","_pc","getSenders","_senders","origAddTrack","addTrack","sender","origRemoveTrack","removeTrack","idx","indexOf","splice","origAddStream","addStream","origRemoveStream","removeStream","s","RTCRtpSender","origGetSenders","senders","shimGetStats","origGetStats","getStats","selector","onSucc","onErr","fixChromeStats_","response","standardReport","report","standardStats","timestamp","localcandidate","remotecandidate","names","stat","makeMapStats","map","successCallbackWrapper_","resolve","shimSenderReceiverGetStats","RTCRtpReceiver","origGetReceivers","receivers","srcElement","MediaStreamTrack","err","shimAddTrackRemoveTrackWithNative","getLocalStreams","_shimmedLocalStreams","streamId","existingSenders","newSenders","newSender","shimAddTrackRemoveTrack","origGetLocalStreams","nativeStreams","_reverseStreams","_streams","newStream","replaceInternalStreamId","description","sdp","internalId","externalStream","internalStream","replace","RegExp","RTCSessionDescription","replaceExternalStreamId","signalingState","t","alreadyExists","oldStream","method","nativeMethod","methodObj","args","desc","origSetLocalDescription","setLocalDescription","origLocalDescription","getOwnPropertyDescriptor","streamid","shimPeerConnection","webkitRTCPeerConnection","RTCIceCandidate","fixNegotiationNeeded","target","getConfiguration","sdpSemantics","catch","RTCIceGatherer","origMSTEnabled","ev","enabled","RTCDtmfSender","RTCDTMFSender","RTCPeerConnectionShim","config","iceServers","edgeVersion","hasTurn","server","urls","url","isString","validTurn","startsWith","filterIceServers","shimReplaceTrack","replaceTrack","setTrack","nativeGetUserMedia","getSettings","nativeGetSettings","applyConstraints","nativeApplyConstraints","preferredMediaSource","code","mediaSource","RTCTrackEvent","mozRTCPeerConnection","modernStatsTypes","inboundrtp","outboundrtp","candidatepair","nativeGetStats","i","shimSenderGetStats","shimReceiverGetStats","shimRemoveStream","shimRTCDataChannel","DataChannel","RTCDataChannel","shimAddTransceiver","origAddTransceiver","addTransceiver","setParametersPromises","initParameters","shouldPerformCheck","sendEncodings","encodingParam","test","rid","TypeError","parseFloat","scaleResolutionDownBy","RangeError","maxFramerate","params","getParameters","encodings","setParameters","shimGetParameters","origGetParameters","shimCreateOffer","origCreateOffer","createOffer","all","finally","shimCreateAnswer","origCreateAnswer","createAnswer","shimLocalStreamsAPI","_localStreams","_addTrack","index","tracks","shimRemoteStreamsAPI","getRemoteStreams","_remoteStreams","_onaddstream","_onaddstreampoly","shimCallbacksAPI","addIceCandidate","successCallback","failureCallback","options","promise","withCallback","candidate","_getUserMedia","shimConstraints","errcb","shimRTCIceServerUrls","OrigPeerConnection","pcConfig","pcConstraints","newIceServers","hasOwnProperty","generateCertificate","shimTrackEventTransceiver","shimCreateOfferLegacy","offerOptions","offerToReceiveAudio","audioTransceiver","getTransceivers","direction","setDirection","offerToReceiveVideo","videoTransceiver","shimAudioContext","AudioContext","webkitAudioContext","shimRTCIceCandidate","NativeRTCIceCandidate","substr","nativeCandidate","parsedCandidate","parseCandidate","augmentedCandidate","toJSON","sdpMid","sdpMLineIndex","usernameFragment","writable","shimMaxMessageSize","_sctp","sctpInDescription","sections","splitSections","shift","mediaSection","mLine","parseMLine","protocol","getRemoteFirefoxVersion","getCanSendMaxMessageSize","remoteIsFirefox","canSendMaxMessageSize","browser","getMaxMessageSize","maxMessageSize","matchPrefix","isFirefox","canSendMMS","remoteMMS","Number","POSITIVE_INFINITY","Math","sctp","shimSendThrowTypeError","wrapDcSend","dc","origDataChannelSend","send","byteLength","readyState","origCreateDataChannel","createDataChannel","dataChannel","channel","shimConnectionState","completed","checking","iceConnectionState","_onconnectionstatechange","origMethod","_connectionstatechangepoly","_lastConnectionState","connectionState","newEvent","removeExtmapAllowMixed","nativeSRD","split","line","trim","join","shimAddIceCandidateNullOrEmpty","nativeAddIceCandidate","shimChrome","shimFirefox","shimEdge","shimSafari","logging","mozGetUserMedia","userAgent","isSecureContext","supportsUnifiedPlan","RTCRtpTransceiver","adapter","commonShim","browserShim","adapterFactory"],"mappings":"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","file":"22.9ce62d8932534966fe04.js","sourcesContent":["var isProduction = process.env.NODE_ENV === 'production';\nfunction warning(condition, message) {\n  if (!isProduction) {\n    if (condition) {\n      return;\n    }\n\n    var text = \"Warning: \" + message;\n\n    if (typeof console !== 'undefined') {\n      console.warn(text);\n    }\n\n    try {\n      throw Error(text);\n    } catch (x) {}\n  }\n}\n\nexport default warning;\n","module.exports = __webpack_public_path__ + \"12c31d4081a9828edb9d938ac731984d.png\";","module.exports = __webpack_public_path__ + \"3fb6926972efb0a74caa4003f5e2d7ed.svg\";","module.exports = __webpack_public_path__ + \"fcab5557f585bccbdc64fee0b5d0a18d.svg\";","module.exports = __webpack_public_path__ + \"f382bced3d3cc0b8eafcd815edee8673.svg\";","module.exports = __webpack_public_path__ + \"0af4803da61c5ca683882a379cdb30a3.svg\";","module.exports = __webpack_public_path__ + \"8290266a5fb402a34b96f890bbdb2d60.png\";","module.exports = __webpack_public_path__ + \"1b5245f0e2c46c8a145524ce870c76b9.png\";","module.exports = __webpack_public_path__ + \"f495f5e0a7dfc701f263e6f81aa35c47.png\";","module.exports = __webpack_public_path__ + \"3f995dc615f2c7b66ab71e4987246b82.png\";","module.exports = __webpack_public_path__ + \"a5fc53e453ca043f41325f1f270cf192.png\";","module.exports = __webpack_public_path__ + \"dd37bdfb57d5f8780757336f15c23019.png\";","module.exports = __webpack_public_path__ + \"b7806be58176555416d337122b5a55f0.svg\";","module.exports = __webpack_public_path__ + \"f7d264bcbf3016c01720964bbb0b0205.svg\";","module.exports = __webpack_public_path__ + \"956633b0e885df9db3a39aae6cebafd1.svg\";","module.exports = __webpack_public_path__ + \"2b14942022269d0439e13eccd0bac564.svg\";","module.exports = __webpack_public_path__ + \"421fa2dada8602457090380595082ef2.png\";","module.exports = __webpack_public_path__ + \"0f3498b57dde4509ff00cec313c9e069.png\";","module.exports = __webpack_public_path__ + \"38aaa05e30638cf43f8cf78790b449aa.png\";","module.exports = __webpack_public_path__ + \"1d74c3106a5ea24ea5e18fa5b3acca38.png\";","module.exports = __webpack_public_path__ + \"aed88bb24648ef6d321bcb9d900d8f0b.svg\";","module.exports = __webpack_public_path__ + \"b01d42ba9f91724e0a80935a2955b1d9.png\";","module.exports = __webpack_public_path__ + \"24725d235b7de9f6db9297eeda01461e.png\";","module.exports = __webpack_public_path__ + \"65ae5273bb0ff8d6758d4d106c0b965d.png\";","module.exports = __webpack_public_path__ + \"5aaecd30e753e5810735c5216d9d0a8d.png\";","module.exports = __webpack_public_path__ + \"9bf8c71c50fa608dacc65a68b7554fcf.png\";","module.exports = __webpack_public_path__ + \"bdc8c1cce5c62e5b2e3d12961dd2f3c4.png\";","module.exports = __webpack_public_path__ + \"e9a977b0307abac6b6b112b7f28cb9fe.png\";","module.exports = __webpack_public_path__ + \"2da2805f67e69ff750984d33aec2ddbe.png\";","module.exports = __webpack_public_path__ + \"c2ce47eca6bd5619f2b9e2c7fe4a1801.png\";","module.exports = __webpack_public_path__ + \"a874accaf0bd51c56793fee87b7aa60b.png\";","module.exports = __webpack_public_path__ + \"784cd37be58e5a27d827ba9f39819c5b.jpg\";","module.exports = __webpack_public_path__ + \"51975c56b95e26c796d3739957042eca.svg\";","module.exports = __webpack_public_path__ + \"33984f0debe7281b72d75baa8195132d.png\";","module.exports = __webpack_public_path__ + \"3e3f0976b58e61d1f770c934b49fe3f0.png\";","module.exports = __webpack_public_path__ + \"8b74a9768aeba5748cec863593400e17.png\";","module.exports = __webpack_public_path__ + \"320fe8b07fbbdecaec80bd77dfe06fbb.svg\";","module.exports = __webpack_public_path__ + \"629cbd8d947de94f359d3194d203080f.svg\";","module.exports = __webpack_public_path__ + \"b8343bee318281c90e81b37ffd01851c.svg\";","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n /* eslint-env node */\n'use strict';\n\nlet logDisabled_ = true;\nlet deprecationWarnings_ = true;\n\n/**\n * Extract browser version out of the provided user agent string.\n *\n * @param {!string} uastring userAgent string.\n * @param {!string} expr Regular expression used as match criteria.\n * @param {!number} pos position in the version string to be returned.\n * @return {!number} browser version.\n */\nexport function extractVersion(uastring, expr, pos) {\n  const match = uastring.match(expr);\n  return match && match.length >= pos && parseInt(match[pos], 10);\n}\n\n// Wraps the peerconnection event eventNameToWrap in a function\n// which returns the modified event object (or false to prevent\n// the event).\nexport function wrapPeerConnectionEvent(window, eventNameToWrap, wrapper) {\n  if (!window.RTCPeerConnection) {\n    return;\n  }\n  const proto = window.RTCPeerConnection.prototype;\n  const nativeAddEventListener = proto.addEventListener;\n  proto.addEventListener = function(nativeEventName, cb) {\n    if (nativeEventName !== eventNameToWrap) {\n      return nativeAddEventListener.apply(this, arguments);\n    }\n    const wrappedCallback = (e) => {\n      const modifiedEvent = wrapper(e);\n      if (modifiedEvent) {\n        if (cb.handleEvent) {\n          cb.handleEvent(modifiedEvent);\n        } else {\n          cb(modifiedEvent);\n        }\n      }\n    };\n    this._eventMap = this._eventMap || {};\n    if (!this._eventMap[eventNameToWrap]) {\n      this._eventMap[eventNameToWrap] = new Map();\n    }\n    this._eventMap[eventNameToWrap].set(cb, wrappedCallback);\n    return nativeAddEventListener.apply(this, [nativeEventName,\n      wrappedCallback]);\n  };\n\n  const nativeRemoveEventListener = proto.removeEventListener;\n  proto.removeEventListener = function(nativeEventName, cb) {\n    if (nativeEventName !== eventNameToWrap || !this._eventMap\n        || !this._eventMap[eventNameToWrap]) {\n      return nativeRemoveEventListener.apply(this, arguments);\n    }\n    if (!this._eventMap[eventNameToWrap].has(cb)) {\n      return nativeRemoveEventListener.apply(this, arguments);\n    }\n    const unwrappedCb = this._eventMap[eventNameToWrap].get(cb);\n    this._eventMap[eventNameToWrap].delete(cb);\n    if (this._eventMap[eventNameToWrap].size === 0) {\n      delete this._eventMap[eventNameToWrap];\n    }\n    if (Object.keys(this._eventMap).length === 0) {\n      delete this._eventMap;\n    }\n    return nativeRemoveEventListener.apply(this, [nativeEventName,\n      unwrappedCb]);\n  };\n\n  Object.defineProperty(proto, 'on' + eventNameToWrap, {\n    get() {\n      return this['_on' + eventNameToWrap];\n    },\n    set(cb) {\n      if (this['_on' + eventNameToWrap]) {\n        this.removeEventListener(eventNameToWrap,\n            this['_on' + eventNameToWrap]);\n        delete this['_on' + eventNameToWrap];\n      }\n      if (cb) {\n        this.addEventListener(eventNameToWrap,\n            this['_on' + eventNameToWrap] = cb);\n      }\n    },\n    enumerable: true,\n    configurable: true\n  });\n}\n\nexport function disableLog(bool) {\n  if (typeof bool !== 'boolean') {\n    return new Error('Argument type: ' + typeof bool +\n        '. Please use a boolean.');\n  }\n  logDisabled_ = bool;\n  return (bool) ? 'adapter.js logging disabled' :\n      'adapter.js logging enabled';\n}\n\n/**\n * Disable or enable deprecation warnings\n * @param {!boolean} bool set to true to disable warnings.\n */\nexport function disableWarnings(bool) {\n  if (typeof bool !== 'boolean') {\n    return new Error('Argument type: ' + typeof bool +\n        '. Please use a boolean.');\n  }\n  deprecationWarnings_ = !bool;\n  return 'adapter.js deprecation warnings ' + (bool ? 'disabled' : 'enabled');\n}\n\nexport function log() {\n  if (typeof window === 'object') {\n    if (logDisabled_) {\n      return;\n    }\n    if (typeof console !== 'undefined' && typeof console.log === 'function') {\n      console.log.apply(console, arguments);\n    }\n  }\n}\n\n/**\n * Shows a deprecation warning suggesting the modern and spec-compatible API.\n */\nexport function deprecated(oldMethod, newMethod) {\n  if (!deprecationWarnings_) {\n    return;\n  }\n  console.warn(oldMethod + ' is deprecated, please use ' + newMethod +\n      ' instead.');\n}\n\n/**\n * Browser detector.\n *\n * @return {object} result containing browser and version\n *     properties.\n */\nexport function detectBrowser(window) {\n  // Returned result object.\n  const result = {browser: null, version: null};\n\n  // Fail early if it's not a browser\n  if (typeof window === 'undefined' || !window.navigator) {\n    result.browser = 'Not a browser.';\n    return result;\n  }\n\n  const {navigator} = window;\n\n  if (navigator.mozGetUserMedia) { // Firefox.\n    result.browser = 'firefox';\n    result.version = extractVersion(navigator.userAgent,\n        /Firefox\\/(\\d+)\\./, 1);\n  } else if (navigator.webkitGetUserMedia ||\n      (window.isSecureContext === false && window.webkitRTCPeerConnection &&\n       !window.RTCIceGatherer)) {\n    // Chrome, Chromium, Webview, Opera.\n    // Version matches Chrome/WebRTC version.\n    // Chrome 74 removed webkitGetUserMedia on http as well so we need the\n    // more complicated fallback to webkitRTCPeerConnection.\n    result.browser = 'chrome';\n    result.version = extractVersion(navigator.userAgent,\n        /Chrom(e|ium)\\/(\\d+)\\./, 2);\n  } else if (navigator.mediaDevices &&\n      navigator.userAgent.match(/Edge\\/(\\d+).(\\d+)$/)) { // Edge.\n    result.browser = 'edge';\n    result.version = extractVersion(navigator.userAgent,\n        /Edge\\/(\\d+).(\\d+)$/, 2);\n  } else if (window.RTCPeerConnection &&\n      navigator.userAgent.match(/AppleWebKit\\/(\\d+)\\./)) { // Safari.\n    result.browser = 'safari';\n    result.version = extractVersion(navigator.userAgent,\n        /AppleWebKit\\/(\\d+)\\./, 1);\n    result.supportsUnifiedPlan = window.RTCRtpTransceiver &&\n        'currentDirection' in window.RTCRtpTransceiver.prototype;\n  } else { // Default fallthrough: not supported.\n    result.browser = 'Not a supported browser.';\n    return result;\n  }\n\n  return result;\n}\n\n/**\n * Checks if something is an object.\n *\n * @param {*} val The something you want to check.\n * @return true if val is an object, false otherwise.\n */\nfunction isObject(val) {\n  return Object.prototype.toString.call(val) === '[object Object]';\n}\n\n/**\n * Remove all empty objects and undefined values\n * from a nested object -- an enhanced and vanilla version\n * of Lodash's `compact`.\n */\nexport function compactObject(data) {\n  if (!isObject(data)) {\n    return data;\n  }\n\n  return Object.keys(data).reduce(function(accumulator, key) {\n    const isObj = isObject(data[key]);\n    const value = isObj ? compactObject(data[key]) : data[key];\n    const isEmptyObject = isObj && !Object.keys(value).length;\n    if (value === undefined || isEmptyObject) {\n      return accumulator;\n    }\n    return Object.assign(accumulator, {[key]: value});\n  }, {});\n}\n\n/* iterates the stats graph recursively. */\nexport function walkStats(stats, base, resultSet) {\n  if (!base || resultSet.has(base.id)) {\n    return;\n  }\n  resultSet.set(base.id, base);\n  Object.keys(base).forEach(name => {\n    if (name.endsWith('Id')) {\n      walkStats(stats, stats.get(base[name]), resultSet);\n    } else if (name.endsWith('Ids')) {\n      base[name].forEach(id => {\n        walkStats(stats, stats.get(id), resultSet);\n      });\n    }\n  });\n}\n\n/* filter getStats for a sender/receiver track. */\nexport function filterStats(result, track, outbound) {\n  const streamStatsType = outbound ? 'outbound-rtp' : 'inbound-rtp';\n  const filteredResult = new Map();\n  if (track === null) {\n    return filteredResult;\n  }\n  const trackStats = [];\n  result.forEach(value => {\n    if (value.type === 'track' &&\n        value.trackIdentifier === track.id) {\n      trackStats.push(value);\n    }\n  });\n  trackStats.forEach(trackStat => {\n    result.forEach(stats => {\n      if (stats.type === streamStatsType && stats.trackId === trackStat.id) {\n        walkStats(result, stats, filteredResult);\n      }\n    });\n  });\n  return filteredResult;\n}\n\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\nimport * as utils from '../utils.js';\nconst logging = utils.log;\n\nexport function shimGetUserMedia(window, browserDetails) {\n  const navigator = window && window.navigator;\n\n  if (!navigator.mediaDevices) {\n    return;\n  }\n\n  const constraintsToChrome_ = function(c) {\n    if (typeof c !== 'object' || c.mandatory || c.optional) {\n      return c;\n    }\n    const cc = {};\n    Object.keys(c).forEach(key => {\n      if (key === 'require' || key === 'advanced' || key === 'mediaSource') {\n        return;\n      }\n      const r = (typeof c[key] === 'object') ? c[key] : {ideal: c[key]};\n      if (r.exact !== undefined && typeof r.exact === 'number') {\n        r.min = r.max = r.exact;\n      }\n      const oldname_ = function(prefix, name) {\n        if (prefix) {\n          return prefix + name.charAt(0).toUpperCase() + name.slice(1);\n        }\n        return (name === 'deviceId') ? 'sourceId' : name;\n      };\n      if (r.ideal !== undefined) {\n        cc.optional = cc.optional || [];\n        let oc = {};\n        if (typeof r.ideal === 'number') {\n          oc[oldname_('min', key)] = r.ideal;\n          cc.optional.push(oc);\n          oc = {};\n          oc[oldname_('max', key)] = r.ideal;\n          cc.optional.push(oc);\n        } else {\n          oc[oldname_('', key)] = r.ideal;\n          cc.optional.push(oc);\n        }\n      }\n      if (r.exact !== undefined && typeof r.exact !== 'number') {\n        cc.mandatory = cc.mandatory || {};\n        cc.mandatory[oldname_('', key)] = r.exact;\n      } else {\n        ['min', 'max'].forEach(mix => {\n          if (r[mix] !== undefined) {\n            cc.mandatory = cc.mandatory || {};\n            cc.mandatory[oldname_(mix, key)] = r[mix];\n          }\n        });\n      }\n    });\n    if (c.advanced) {\n      cc.optional = (cc.optional || []).concat(c.advanced);\n    }\n    return cc;\n  };\n\n  const shimConstraints_ = function(constraints, func) {\n    if (browserDetails.version >= 61) {\n      return func(constraints);\n    }\n    constraints = JSON.parse(JSON.stringify(constraints));\n    if (constraints && typeof constraints.audio === 'object') {\n      const remap = function(obj, a, b) {\n        if (a in obj && !(b in obj)) {\n          obj[b] = obj[a];\n          delete obj[a];\n        }\n      };\n      constraints = JSON.parse(JSON.stringify(constraints));\n      remap(constraints.audio, 'autoGainControl', 'googAutoGainControl');\n      remap(constraints.audio, 'noiseSuppression', 'googNoiseSuppression');\n      constraints.audio = constraintsToChrome_(constraints.audio);\n    }\n    if (constraints && typeof constraints.video === 'object') {\n      // Shim facingMode for mobile & surface pro.\n      let face = constraints.video.facingMode;\n      face = face && ((typeof face === 'object') ? face : {ideal: face});\n      const getSupportedFacingModeLies = browserDetails.version < 66;\n\n      if ((face && (face.exact === 'user' || face.exact === 'environment' ||\n                    face.ideal === 'user' || face.ideal === 'environment')) &&\n          !(navigator.mediaDevices.getSupportedConstraints &&\n            navigator.mediaDevices.getSupportedConstraints().facingMode &&\n            !getSupportedFacingModeLies)) {\n        delete constraints.video.facingMode;\n        let matches;\n        if (face.exact === 'environment' || face.ideal === 'environment') {\n          matches = ['back', 'rear'];\n        } else if (face.exact === 'user' || face.ideal === 'user') {\n          matches = ['front'];\n        }\n        if (matches) {\n          // Look for matches in label, or use last cam for back (typical).\n          return navigator.mediaDevices.enumerateDevices()\n          .then(devices => {\n            devices = devices.filter(d => d.kind === 'videoinput');\n            let dev = devices.find(d => matches.some(match =>\n              d.label.toLowerCase().includes(match)));\n            if (!dev && devices.length && matches.includes('back')) {\n              dev = devices[devices.length - 1]; // more likely the back cam\n            }\n            if (dev) {\n              constraints.video.deviceId = face.exact ? {exact: dev.deviceId} :\n                                                        {ideal: dev.deviceId};\n            }\n            constraints.video = constraintsToChrome_(constraints.video);\n            logging('chrome: ' + JSON.stringify(constraints));\n            return func(constraints);\n          });\n        }\n      }\n      constraints.video = constraintsToChrome_(constraints.video);\n    }\n    logging('chrome: ' + JSON.stringify(constraints));\n    return func(constraints);\n  };\n\n  const shimError_ = function(e) {\n    if (browserDetails.version >= 64) {\n      return e;\n    }\n    return {\n      name: {\n        PermissionDeniedError: 'NotAllowedError',\n        PermissionDismissedError: 'NotAllowedError',\n        InvalidStateError: 'NotAllowedError',\n        DevicesNotFoundError: 'NotFoundError',\n        ConstraintNotSatisfiedError: 'OverconstrainedError',\n        TrackStartError: 'NotReadableError',\n        MediaDeviceFailedDueToShutdown: 'NotAllowedError',\n        MediaDeviceKillSwitchOn: 'NotAllowedError',\n        TabCaptureError: 'AbortError',\n        ScreenCaptureError: 'AbortError',\n        DeviceCaptureError: 'AbortError'\n      }[e.name] || e.name,\n      message: e.message,\n      constraint: e.constraint || e.constraintName,\n      toString() {\n        return this.name + (this.message && ': ') + this.message;\n      }\n    };\n  };\n\n  const getUserMedia_ = function(constraints, onSuccess, onError) {\n    shimConstraints_(constraints, c => {\n      navigator.webkitGetUserMedia(c, onSuccess, e => {\n        if (onError) {\n          onError(shimError_(e));\n        }\n      });\n    });\n  };\n  navigator.getUserMedia = getUserMedia_.bind(navigator);\n\n  // Even though Chrome 45 has navigator.mediaDevices and a getUserMedia\n  // function which returns a Promise, it does not accept spec-style\n  // constraints.\n  if (navigator.mediaDevices.getUserMedia) {\n    const origGetUserMedia = navigator.mediaDevices.getUserMedia.\n        bind(navigator.mediaDevices);\n    navigator.mediaDevices.getUserMedia = function(cs) {\n      return shimConstraints_(cs, c => origGetUserMedia(c).then(stream => {\n        if (c.audio && !stream.getAudioTracks().length ||\n            c.video && !stream.getVideoTracks().length) {\n          stream.getTracks().forEach(track => {\n            track.stop();\n          });\n          throw new DOMException('', 'NotFoundError');\n        }\n        return stream;\n      }, e => Promise.reject(shimError_(e))));\n    };\n  }\n}\n","/*\n *  Copyright (c) 2018 The adapter.js project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\nexport function shimGetDisplayMedia(window, getSourceId) {\n  if (window.navigator.mediaDevices &&\n    'getDisplayMedia' in window.navigator.mediaDevices) {\n    return;\n  }\n  if (!(window.navigator.mediaDevices)) {\n    return;\n  }\n  // getSourceId is a function that returns a promise resolving with\n  // the sourceId of the screen/window/tab to be shared.\n  if (typeof getSourceId !== 'function') {\n    console.error('shimGetDisplayMedia: getSourceId argument is not ' +\n        'a function');\n    return;\n  }\n  window.navigator.mediaDevices.getDisplayMedia =\n    function getDisplayMedia(constraints) {\n      return getSourceId(constraints)\n        .then(sourceId => {\n          const widthSpecified = constraints.video && constraints.video.width;\n          const heightSpecified = constraints.video &&\n            constraints.video.height;\n          const frameRateSpecified = constraints.video &&\n            constraints.video.frameRate;\n          constraints.video = {\n            mandatory: {\n              chromeMediaSource: 'desktop',\n              chromeMediaSourceId: sourceId,\n              maxFrameRate: frameRateSpecified || 3\n            }\n          };\n          if (widthSpecified) {\n            constraints.video.mandatory.maxWidth = widthSpecified;\n          }\n          if (heightSpecified) {\n            constraints.video.mandatory.maxHeight = heightSpecified;\n          }\n          return window.navigator.mediaDevices.getUserMedia(constraints);\n        });\n    };\n}\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n /* eslint-env node */\n'use strict';\nimport * as utils from '../utils.js';\n\nexport {shimGetUserMedia} from './getusermedia';\nexport {shimGetDisplayMedia} from './getdisplaymedia';\n\nexport function shimMediaStream(window) {\n  window.MediaStream = window.MediaStream || window.webkitMediaStream;\n}\n\nexport function shimOnTrack(window) {\n  if (typeof window === 'object' && window.RTCPeerConnection && !('ontrack' in\n      window.RTCPeerConnection.prototype)) {\n    Object.defineProperty(window.RTCPeerConnection.prototype, 'ontrack', {\n      get() {\n        return this._ontrack;\n      },\n      set(f) {\n        if (this._ontrack) {\n          this.removeEventListener('track', this._ontrack);\n        }\n        this.addEventListener('track', this._ontrack = f);\n      },\n      enumerable: true,\n      configurable: true\n    });\n    const origSetRemoteDescription =\n        window.RTCPeerConnection.prototype.setRemoteDescription;\n    window.RTCPeerConnection.prototype.setRemoteDescription =\n      function setRemoteDescription() {\n        if (!this._ontrackpoly) {\n          this._ontrackpoly = (e) => {\n            // onaddstream does not fire when a track is added to an existing\n            // stream. But stream.onaddtrack is implemented so we use that.\n            e.stream.addEventListener('addtrack', te => {\n              let receiver;\n              if (window.RTCPeerConnection.prototype.getReceivers) {\n                receiver = this.getReceivers()\n                  .find(r => r.track && r.track.id === te.track.id);\n              } else {\n                receiver = {track: te.track};\n              }\n\n              const event = new Event('track');\n              event.track = te.track;\n              event.receiver = receiver;\n              event.transceiver = {receiver};\n              event.streams = [e.stream];\n              this.dispatchEvent(event);\n            });\n            e.stream.getTracks().forEach(track => {\n              let receiver;\n              if (window.RTCPeerConnection.prototype.getReceivers) {\n                receiver = this.getReceivers()\n                  .find(r => r.track && r.track.id === track.id);\n              } else {\n                receiver = {track};\n              }\n              const event = new Event('track');\n              event.track = track;\n              event.receiver = receiver;\n              event.transceiver = {receiver};\n              event.streams = [e.stream];\n              this.dispatchEvent(event);\n            });\n          };\n          this.addEventListener('addstream', this._ontrackpoly);\n        }\n        return origSetRemoteDescription.apply(this, arguments);\n      };\n  } else {\n    // even if RTCRtpTransceiver is in window, it is only used and\n    // emitted in unified-plan. Unfortunately this means we need\n    // to unconditionally wrap the event.\n    utils.wrapPeerConnectionEvent(window, 'track', e => {\n      if (!e.transceiver) {\n        Object.defineProperty(e, 'transceiver',\n          {value: {receiver: e.receiver}});\n      }\n      return e;\n    });\n  }\n}\n\nexport function shimGetSendersWithDtmf(window) {\n  // Overrides addTrack/removeTrack, depends on shimAddTrackRemoveTrack.\n  if (typeof window === 'object' && window.RTCPeerConnection &&\n      !('getSenders' in window.RTCPeerConnection.prototype) &&\n      'createDTMFSender' in window.RTCPeerConnection.prototype) {\n    const shimSenderWithDtmf = function(pc, track) {\n      return {\n        track,\n        get dtmf() {\n          if (this._dtmf === undefined) {\n            if (track.kind === 'audio') {\n              this._dtmf = pc.createDTMFSender(track);\n            } else {\n              this._dtmf = null;\n            }\n          }\n          return this._dtmf;\n        },\n        _pc: pc\n      };\n    };\n\n    // augment addTrack when getSenders is not available.\n    if (!window.RTCPeerConnection.prototype.getSenders) {\n      window.RTCPeerConnection.prototype.getSenders = function getSenders() {\n        this._senders = this._senders || [];\n        return this._senders.slice(); // return a copy of the internal state.\n      };\n      const origAddTrack = window.RTCPeerConnection.prototype.addTrack;\n      window.RTCPeerConnection.prototype.addTrack =\n        function addTrack(track, stream) {\n          let sender = origAddTrack.apply(this, arguments);\n          if (!sender) {\n            sender = shimSenderWithDtmf(this, track);\n            this._senders.push(sender);\n          }\n          return sender;\n        };\n\n      const origRemoveTrack = window.RTCPeerConnection.prototype.removeTrack;\n      window.RTCPeerConnection.prototype.removeTrack =\n        function removeTrack(sender) {\n          origRemoveTrack.apply(this, arguments);\n          const idx = this._senders.indexOf(sender);\n          if (idx !== -1) {\n            this._senders.splice(idx, 1);\n          }\n        };\n    }\n    const origAddStream = window.RTCPeerConnection.prototype.addStream;\n    window.RTCPeerConnection.prototype.addStream = function addStream(stream) {\n      this._senders = this._senders || [];\n      origAddStream.apply(this, [stream]);\n      stream.getTracks().forEach(track => {\n        this._senders.push(shimSenderWithDtmf(this, track));\n      });\n    };\n\n    const origRemoveStream = window.RTCPeerConnection.prototype.removeStream;\n    window.RTCPeerConnection.prototype.removeStream =\n      function removeStream(stream) {\n        this._senders = this._senders || [];\n        origRemoveStream.apply(this, [stream]);\n\n        stream.getTracks().forEach(track => {\n          const sender = this._senders.find(s => s.track === track);\n          if (sender) { // remove sender\n            this._senders.splice(this._senders.indexOf(sender), 1);\n          }\n        });\n      };\n  } else if (typeof window === 'object' && window.RTCPeerConnection &&\n             'getSenders' in window.RTCPeerConnection.prototype &&\n             'createDTMFSender' in window.RTCPeerConnection.prototype &&\n             window.RTCRtpSender &&\n             !('dtmf' in window.RTCRtpSender.prototype)) {\n    const origGetSenders = window.RTCPeerConnection.prototype.getSenders;\n    window.RTCPeerConnection.prototype.getSenders = function getSenders() {\n      const senders = origGetSenders.apply(this, []);\n      senders.forEach(sender => sender._pc = this);\n      return senders;\n    };\n\n    Object.defineProperty(window.RTCRtpSender.prototype, 'dtmf', {\n      get() {\n        if (this._dtmf === undefined) {\n          if (this.track.kind === 'audio') {\n            this._dtmf = this._pc.createDTMFSender(this.track);\n          } else {\n            this._dtmf = null;\n          }\n        }\n        return this._dtmf;\n      }\n    });\n  }\n}\n\nexport function shimGetStats(window) {\n  if (!window.RTCPeerConnection) {\n    return;\n  }\n\n  const origGetStats = window.RTCPeerConnection.prototype.getStats;\n  window.RTCPeerConnection.prototype.getStats = function getStats() {\n    const [selector, onSucc, onErr] = arguments;\n\n    // If selector is a function then we are in the old style stats so just\n    // pass back the original getStats format to avoid breaking old users.\n    if (arguments.length > 0 && typeof selector === 'function') {\n      return origGetStats.apply(this, arguments);\n    }\n\n    // When spec-style getStats is supported, return those when called with\n    // either no arguments or the selector argument is null.\n    if (origGetStats.length === 0 && (arguments.length === 0 ||\n        typeof selector !== 'function')) {\n      return origGetStats.apply(this, []);\n    }\n\n    const fixChromeStats_ = function(response) {\n      const standardReport = {};\n      const reports = response.result();\n      reports.forEach(report => {\n        const standardStats = {\n          id: report.id,\n          timestamp: report.timestamp,\n          type: {\n            localcandidate: 'local-candidate',\n            remotecandidate: 'remote-candidate'\n          }[report.type] || report.type\n        };\n        report.names().forEach(name => {\n          standardStats[name] = report.stat(name);\n        });\n        standardReport[standardStats.id] = standardStats;\n      });\n\n      return standardReport;\n    };\n\n    // shim getStats with maplike support\n    const makeMapStats = function(stats) {\n      return new Map(Object.keys(stats).map(key => [key, stats[key]]));\n    };\n\n    if (arguments.length >= 2) {\n      const successCallbackWrapper_ = function(response) {\n        onSucc(makeMapStats(fixChromeStats_(response)));\n      };\n\n      return origGetStats.apply(this, [successCallbackWrapper_,\n        selector]);\n    }\n\n    // promise-support\n    return new Promise((resolve, reject) => {\n      origGetStats.apply(this, [\n        function(response) {\n          resolve(makeMapStats(fixChromeStats_(response)));\n        }, reject]);\n    }).then(onSucc, onErr);\n  };\n}\n\nexport function shimSenderReceiverGetStats(window) {\n  if (!(typeof window === 'object' && window.RTCPeerConnection &&\n      window.RTCRtpSender && window.RTCRtpReceiver)) {\n    return;\n  }\n\n  // shim sender stats.\n  if (!('getStats' in window.RTCRtpSender.prototype)) {\n    const origGetSenders = window.RTCPeerConnection.prototype.getSenders;\n    if (origGetSenders) {\n      window.RTCPeerConnection.prototype.getSenders = function getSenders() {\n        const senders = origGetSenders.apply(this, []);\n        senders.forEach(sender => sender._pc = this);\n        return senders;\n      };\n    }\n\n    const origAddTrack = window.RTCPeerConnection.prototype.addTrack;\n    if (origAddTrack) {\n      window.RTCPeerConnection.prototype.addTrack = function addTrack() {\n        const sender = origAddTrack.apply(this, arguments);\n        sender._pc = this;\n        return sender;\n      };\n    }\n    window.RTCRtpSender.prototype.getStats = function getStats() {\n      const sender = this;\n      return this._pc.getStats().then(result =>\n        /* Note: this will include stats of all senders that\n         *   send a track with the same id as sender.track as\n         *   it is not possible to identify the RTCRtpSender.\n         */\n        utils.filterStats(result, sender.track, true));\n    };\n  }\n\n  // shim receiver stats.\n  if (!('getStats' in window.RTCRtpReceiver.prototype)) {\n    const origGetReceivers = window.RTCPeerConnection.prototype.getReceivers;\n    if (origGetReceivers) {\n      window.RTCPeerConnection.prototype.getReceivers =\n        function getReceivers() {\n          const receivers = origGetReceivers.apply(this, []);\n          receivers.forEach(receiver => receiver._pc = this);\n          return receivers;\n        };\n    }\n    utils.wrapPeerConnectionEvent(window, 'track', e => {\n      e.receiver._pc = e.srcElement;\n      return e;\n    });\n    window.RTCRtpReceiver.prototype.getStats = function getStats() {\n      const receiver = this;\n      return this._pc.getStats().then(result =>\n        utils.filterStats(result, receiver.track, false));\n    };\n  }\n\n  if (!('getStats' in window.RTCRtpSender.prototype &&\n      'getStats' in window.RTCRtpReceiver.prototype)) {\n    return;\n  }\n\n  // shim RTCPeerConnection.getStats(track).\n  const origGetStats = window.RTCPeerConnection.prototype.getStats;\n  window.RTCPeerConnection.prototype.getStats = function getStats() {\n    if (arguments.length > 0 &&\n        arguments[0] instanceof window.MediaStreamTrack) {\n      const track = arguments[0];\n      let sender;\n      let receiver;\n      let err;\n      this.getSenders().forEach(s => {\n        if (s.track === track) {\n          if (sender) {\n            err = true;\n          } else {\n            sender = s;\n          }\n        }\n      });\n      this.getReceivers().forEach(r => {\n        if (r.track === track) {\n          if (receiver) {\n            err = true;\n          } else {\n            receiver = r;\n          }\n        }\n        return r.track === track;\n      });\n      if (err || (sender && receiver)) {\n        return Promise.reject(new DOMException(\n          'There are more than one sender or receiver for the track.',\n          'InvalidAccessError'));\n      } else if (sender) {\n        return sender.getStats();\n      } else if (receiver) {\n        return receiver.getStats();\n      }\n      return Promise.reject(new DOMException(\n        'There is no sender or receiver for the track.',\n        'InvalidAccessError'));\n    }\n    return origGetStats.apply(this, arguments);\n  };\n}\n\nexport function shimAddTrackRemoveTrackWithNative(window) {\n  // shim addTrack/removeTrack with native variants in order to make\n  // the interactions with legacy getLocalStreams behave as in other browsers.\n  // Keeps a mapping stream.id => [stream, rtpsenders...]\n  window.RTCPeerConnection.prototype.getLocalStreams =\n    function getLocalStreams() {\n      this._shimmedLocalStreams = this._shimmedLocalStreams || {};\n      return Object.keys(this._shimmedLocalStreams)\n        .map(streamId => this._shimmedLocalStreams[streamId][0]);\n    };\n\n  const origAddTrack = window.RTCPeerConnection.prototype.addTrack;\n  window.RTCPeerConnection.prototype.addTrack =\n    function addTrack(track, stream) {\n      if (!stream) {\n        return origAddTrack.apply(this, arguments);\n      }\n      this._shimmedLocalStreams = this._shimmedLocalStreams || {};\n\n      const sender = origAddTrack.apply(this, arguments);\n      if (!this._shimmedLocalStreams[stream.id]) {\n        this._shimmedLocalStreams[stream.id] = [stream, sender];\n      } else if (this._shimmedLocalStreams[stream.id].indexOf(sender) === -1) {\n        this._shimmedLocalStreams[stream.id].push(sender);\n      }\n      return sender;\n    };\n\n  const origAddStream = window.RTCPeerConnection.prototype.addStream;\n  window.RTCPeerConnection.prototype.addStream = function addStream(stream) {\n    this._shimmedLocalStreams = this._shimmedLocalStreams || {};\n\n    stream.getTracks().forEach(track => {\n      const alreadyExists = this.getSenders().find(s => s.track === track);\n      if (alreadyExists) {\n        throw new DOMException('Track already exists.',\n            'InvalidAccessError');\n      }\n    });\n    const existingSenders = this.getSenders();\n    origAddStream.apply(this, arguments);\n    const newSenders = this.getSenders()\n      .filter(newSender => existingSenders.indexOf(newSender) === -1);\n    this._shimmedLocalStreams[stream.id] = [stream].concat(newSenders);\n  };\n\n  const origRemoveStream = window.RTCPeerConnection.prototype.removeStream;\n  window.RTCPeerConnection.prototype.removeStream =\n    function removeStream(stream) {\n      this._shimmedLocalStreams = this._shimmedLocalStreams || {};\n      delete this._shimmedLocalStreams[stream.id];\n      return origRemoveStream.apply(this, arguments);\n    };\n\n  const origRemoveTrack = window.RTCPeerConnection.prototype.removeTrack;\n  window.RTCPeerConnection.prototype.removeTrack =\n    function removeTrack(sender) {\n      this._shimmedLocalStreams = this._shimmedLocalStreams || {};\n      if (sender) {\n        Object.keys(this._shimmedLocalStreams).forEach(streamId => {\n          const idx = this._shimmedLocalStreams[streamId].indexOf(sender);\n          if (idx !== -1) {\n            this._shimmedLocalStreams[streamId].splice(idx, 1);\n          }\n          if (this._shimmedLocalStreams[streamId].length === 1) {\n            delete this._shimmedLocalStreams[streamId];\n          }\n        });\n      }\n      return origRemoveTrack.apply(this, arguments);\n    };\n}\n\nexport function shimAddTrackRemoveTrack(window, browserDetails) {\n  if (!window.RTCPeerConnection) {\n    return;\n  }\n  // shim addTrack and removeTrack.\n  if (window.RTCPeerConnection.prototype.addTrack &&\n      browserDetails.version >= 65) {\n    return shimAddTrackRemoveTrackWithNative(window);\n  }\n\n  // also shim pc.getLocalStreams when addTrack is shimmed\n  // to return the original streams.\n  const origGetLocalStreams = window.RTCPeerConnection.prototype\n      .getLocalStreams;\n  window.RTCPeerConnection.prototype.getLocalStreams =\n    function getLocalStreams() {\n      const nativeStreams = origGetLocalStreams.apply(this);\n      this._reverseStreams = this._reverseStreams || {};\n      return nativeStreams.map(stream => this._reverseStreams[stream.id]);\n    };\n\n  const origAddStream = window.RTCPeerConnection.prototype.addStream;\n  window.RTCPeerConnection.prototype.addStream = function addStream(stream) {\n    this._streams = this._streams || {};\n    this._reverseStreams = this._reverseStreams || {};\n\n    stream.getTracks().forEach(track => {\n      const alreadyExists = this.getSenders().find(s => s.track === track);\n      if (alreadyExists) {\n        throw new DOMException('Track already exists.',\n            'InvalidAccessError');\n      }\n    });\n    // Add identity mapping for consistency with addTrack.\n    // Unless this is being used with a stream from addTrack.\n    if (!this._reverseStreams[stream.id]) {\n      const newStream = new window.MediaStream(stream.getTracks());\n      this._streams[stream.id] = newStream;\n      this._reverseStreams[newStream.id] = stream;\n      stream = newStream;\n    }\n    origAddStream.apply(this, [stream]);\n  };\n\n  const origRemoveStream = window.RTCPeerConnection.prototype.removeStream;\n  window.RTCPeerConnection.prototype.removeStream =\n    function removeStream(stream) {\n      this._streams = this._streams || {};\n      this._reverseStreams = this._reverseStreams || {};\n\n      origRemoveStream.apply(this, [(this._streams[stream.id] || stream)]);\n      delete this._reverseStreams[(this._streams[stream.id] ?\n          this._streams[stream.id].id : stream.id)];\n      delete this._streams[stream.id];\n    };\n\n  window.RTCPeerConnection.prototype.addTrack =\n    function addTrack(track, stream) {\n      if (this.signalingState === 'closed') {\n        throw new DOMException(\n          'The RTCPeerConnection\\'s signalingState is \\'closed\\'.',\n          'InvalidStateError');\n      }\n      const streams = [].slice.call(arguments, 1);\n      if (streams.length !== 1 ||\n          !streams[0].getTracks().find(t => t === track)) {\n        // this is not fully correct but all we can manage without\n        // [[associated MediaStreams]] internal slot.\n        throw new DOMException(\n          'The adapter.js addTrack polyfill only supports a single ' +\n          ' stream which is associated with the specified track.',\n          'NotSupportedError');\n      }\n\n      const alreadyExists = this.getSenders().find(s => s.track === track);\n      if (alreadyExists) {\n        throw new DOMException('Track already exists.',\n            'InvalidAccessError');\n      }\n\n      this._streams = this._streams || {};\n      this._reverseStreams = this._reverseStreams || {};\n      const oldStream = this._streams[stream.id];\n      if (oldStream) {\n        // this is using odd Chrome behaviour, use with caution:\n        // https://bugs.chromium.org/p/webrtc/issues/detail?id=7815\n        // Note: we rely on the high-level addTrack/dtmf shim to\n        // create the sender with a dtmf sender.\n        oldStream.addTrack(track);\n\n        // Trigger ONN async.\n        Promise.resolve().then(() => {\n          this.dispatchEvent(new Event('negotiationneeded'));\n        });\n      } else {\n        const newStream = new window.MediaStream([track]);\n        this._streams[stream.id] = newStream;\n        this._reverseStreams[newStream.id] = stream;\n        this.addStream(newStream);\n      }\n      return this.getSenders().find(s => s.track === track);\n    };\n\n  // replace the internal stream id with the external one and\n  // vice versa.\n  function replaceInternalStreamId(pc, description) {\n    let sdp = description.sdp;\n    Object.keys(pc._reverseStreams || []).forEach(internalId => {\n      const externalStream = pc._reverseStreams[internalId];\n      const internalStream = pc._streams[externalStream.id];\n      sdp = sdp.replace(new RegExp(internalStream.id, 'g'),\n          externalStream.id);\n    });\n    return new RTCSessionDescription({\n      type: description.type,\n      sdp\n    });\n  }\n  function replaceExternalStreamId(pc, description) {\n    let sdp = description.sdp;\n    Object.keys(pc._reverseStreams || []).forEach(internalId => {\n      const externalStream = pc._reverseStreams[internalId];\n      const internalStream = pc._streams[externalStream.id];\n      sdp = sdp.replace(new RegExp(externalStream.id, 'g'),\n          internalStream.id);\n    });\n    return new RTCSessionDescription({\n      type: description.type,\n      sdp\n    });\n  }\n  ['createOffer', 'createAnswer'].forEach(function(method) {\n    const nativeMethod = window.RTCPeerConnection.prototype[method];\n    const methodObj = {[method]() {\n      const args = arguments;\n      const isLegacyCall = arguments.length &&\n          typeof arguments[0] === 'function';\n      if (isLegacyCall) {\n        return nativeMethod.apply(this, [\n          (description) => {\n            const desc = replaceInternalStreamId(this, description);\n            args[0].apply(null, [desc]);\n          },\n          (err) => {\n            if (args[1]) {\n              args[1].apply(null, err);\n            }\n          }, arguments[2]\n        ]);\n      }\n      return nativeMethod.apply(this, arguments)\n      .then(description => replaceInternalStreamId(this, description));\n    }};\n    window.RTCPeerConnection.prototype[method] = methodObj[method];\n  });\n\n  const origSetLocalDescription =\n      window.RTCPeerConnection.prototype.setLocalDescription;\n  window.RTCPeerConnection.prototype.setLocalDescription =\n    function setLocalDescription() {\n      if (!arguments.length || !arguments[0].type) {\n        return origSetLocalDescription.apply(this, arguments);\n      }\n      arguments[0] = replaceExternalStreamId(this, arguments[0]);\n      return origSetLocalDescription.apply(this, arguments);\n    };\n\n  // TODO: mangle getStats: https://w3c.github.io/webrtc-stats/#dom-rtcmediastreamstats-streamidentifier\n\n  const origLocalDescription = Object.getOwnPropertyDescriptor(\n      window.RTCPeerConnection.prototype, 'localDescription');\n  Object.defineProperty(window.RTCPeerConnection.prototype,\n      'localDescription', {\n        get() {\n          const description = origLocalDescription.get.apply(this);\n          if (description.type === '') {\n            return description;\n          }\n          return replaceInternalStreamId(this, description);\n        }\n      });\n\n  window.RTCPeerConnection.prototype.removeTrack =\n    function removeTrack(sender) {\n      if (this.signalingState === 'closed') {\n        throw new DOMException(\n          'The RTCPeerConnection\\'s signalingState is \\'closed\\'.',\n          'InvalidStateError');\n      }\n      // We can not yet check for sender instanceof RTCRtpSender\n      // since we shim RTPSender. So we check if sender._pc is set.\n      if (!sender._pc) {\n        throw new DOMException('Argument 1 of RTCPeerConnection.removeTrack ' +\n            'does not implement interface RTCRtpSender.', 'TypeError');\n      }\n      const isLocal = sender._pc === this;\n      if (!isLocal) {\n        throw new DOMException('Sender was not created by this connection.',\n            'InvalidAccessError');\n      }\n\n      // Search for the native stream the senders track belongs to.\n      this._streams = this._streams || {};\n      let stream;\n      Object.keys(this._streams).forEach(streamid => {\n        const hasTrack = this._streams[streamid].getTracks()\n          .find(track => sender.track === track);\n        if (hasTrack) {\n          stream = this._streams[streamid];\n        }\n      });\n\n      if (stream) {\n        if (stream.getTracks().length === 1) {\n          // if this is the last track of the stream, remove the stream. This\n          // takes care of any shimmed _senders.\n          this.removeStream(this._reverseStreams[stream.id]);\n        } else {\n          // relying on the same odd chrome behaviour as above.\n          stream.removeTrack(sender.track);\n        }\n        this.dispatchEvent(new Event('negotiationneeded'));\n      }\n    };\n}\n\nexport function shimPeerConnection(window, browserDetails) {\n  if (!window.RTCPeerConnection && window.webkitRTCPeerConnection) {\n    // very basic support for old versions.\n    window.RTCPeerConnection = window.webkitRTCPeerConnection;\n  }\n  if (!window.RTCPeerConnection) {\n    return;\n  }\n\n  // shim implicit creation of RTCSessionDescription/RTCIceCandidate\n  if (browserDetails.version < 53) {\n    ['setLocalDescription', 'setRemoteDescription', 'addIceCandidate']\n        .forEach(function(method) {\n          const nativeMethod = window.RTCPeerConnection.prototype[method];\n          const methodObj = {[method]() {\n            arguments[0] = new ((method === 'addIceCandidate') ?\n                window.RTCIceCandidate :\n                window.RTCSessionDescription)(arguments[0]);\n            return nativeMethod.apply(this, arguments);\n          }};\n          window.RTCPeerConnection.prototype[method] = methodObj[method];\n        });\n  }\n}\n\n// Attempt to fix ONN in plan-b mode.\nexport function fixNegotiationNeeded(window, browserDetails) {\n  utils.wrapPeerConnectionEvent(window, 'negotiationneeded', e => {\n    const pc = e.target;\n    if (browserDetails.version < 72 || (pc.getConfiguration &&\n        pc.getConfiguration().sdpSemantics === 'plan-b')) {\n      if (pc.signalingState !== 'stable') {\n        return;\n      }\n    }\n    return e;\n  });\n}\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n /* eslint-env node */\n'use strict';\n\nexport function shimGetUserMedia(window) {\n  const navigator = window && window.navigator;\n\n  const shimError_ = function(e) {\n    return {\n      name: {PermissionDeniedError: 'NotAllowedError'}[e.name] || e.name,\n      message: e.message,\n      constraint: e.constraint,\n      toString() {\n        return this.name;\n      }\n    };\n  };\n\n  // getUserMedia error shim.\n  const origGetUserMedia = navigator.mediaDevices.getUserMedia.\n      bind(navigator.mediaDevices);\n  navigator.mediaDevices.getUserMedia = function(c) {\n    return origGetUserMedia(c).catch(e => Promise.reject(shimError_(e)));\n  };\n}\n","/*\n *  Copyright (c) 2018 The adapter.js project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n /* eslint-env node */\n'use strict';\n\nexport function shimGetDisplayMedia(window) {\n  if (!('getDisplayMedia' in window.navigator)) {\n    return;\n  }\n  if (!(window.navigator.mediaDevices)) {\n    return;\n  }\n  if (window.navigator.mediaDevices &&\n    'getDisplayMedia' in window.navigator.mediaDevices) {\n    return;\n  }\n  window.navigator.mediaDevices.getDisplayMedia =\n    window.navigator.getDisplayMedia.bind(window.navigator);\n}\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nimport * as utils from '../utils';\nimport {filterIceServers} from './filtericeservers';\nimport shimRTCPeerConnection from 'rtcpeerconnection-shim';\n\nexport {shimGetUserMedia} from './getusermedia';\nexport {shimGetDisplayMedia} from './getdisplaymedia';\n\nexport function shimPeerConnection(window, browserDetails) {\n  if (window.RTCIceGatherer) {\n    if (!window.RTCIceCandidate) {\n      window.RTCIceCandidate = function RTCIceCandidate(args) {\n        return args;\n      };\n    }\n    if (!window.RTCSessionDescription) {\n      window.RTCSessionDescription = function RTCSessionDescription(args) {\n        return args;\n      };\n    }\n    // this adds an additional event listener to MediaStrackTrack that signals\n    // when a tracks enabled property was changed. Workaround for a bug in\n    // addStream, see below. No longer required in 15025+\n    if (browserDetails.version < 15025) {\n      const origMSTEnabled = Object.getOwnPropertyDescriptor(\n          window.MediaStreamTrack.prototype, 'enabled');\n      Object.defineProperty(window.MediaStreamTrack.prototype, 'enabled', {\n        set(value) {\n          origMSTEnabled.set.call(this, value);\n          const ev = new Event('enabled');\n          ev.enabled = value;\n          this.dispatchEvent(ev);\n        }\n      });\n    }\n  }\n\n  // ORTC defines the DTMF sender a bit different.\n  // https://github.com/w3c/ortc/issues/714\n  if (window.RTCRtpSender && !('dtmf' in window.RTCRtpSender.prototype)) {\n    Object.defineProperty(window.RTCRtpSender.prototype, 'dtmf', {\n      get() {\n        if (this._dtmf === undefined) {\n          if (this.track.kind === 'audio') {\n            this._dtmf = new window.RTCDtmfSender(this);\n          } else if (this.track.kind === 'video') {\n            this._dtmf = null;\n          }\n        }\n        return this._dtmf;\n      }\n    });\n  }\n  // Edge currently only implements the RTCDtmfSender, not the\n  // RTCDTMFSender alias. See http://draft.ortc.org/#rtcdtmfsender2*\n  if (window.RTCDtmfSender && !window.RTCDTMFSender) {\n    window.RTCDTMFSender = window.RTCDtmfSender;\n  }\n\n  const RTCPeerConnectionShim = shimRTCPeerConnection(window,\n      browserDetails.version);\n  window.RTCPeerConnection = function RTCPeerConnection(config) {\n    if (config && config.iceServers) {\n      config.iceServers = filterIceServers(config.iceServers,\n        browserDetails.version);\n      utils.log('ICE servers after filtering:', config.iceServers);\n    }\n    return new RTCPeerConnectionShim(config);\n  };\n  window.RTCPeerConnection.prototype = RTCPeerConnectionShim.prototype;\n}\n\nexport function shimReplaceTrack(window) {\n  // ORTC has replaceTrack -- https://github.com/w3c/ortc/issues/614\n  if (window.RTCRtpSender &&\n      !('replaceTrack' in window.RTCRtpSender.prototype)) {\n    window.RTCRtpSender.prototype.replaceTrack =\n        window.RTCRtpSender.prototype.setTrack;\n  }\n}\n","/*\n *  Copyright (c) 2018 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nimport * as utils from '../utils';\n// Edge does not like\n// 1) stun: filtered after 14393 unless ?transport=udp is present\n// 2) turn: that does not have all of turn:host:port?transport=udp\n// 3) turn: with ipv6 addresses\n// 4) turn: occurring muliple times\nexport function filterIceServers(iceServers, edgeVersion) {\n  let hasTurn = false;\n  iceServers = JSON.parse(JSON.stringify(iceServers));\n  return iceServers.filter(server => {\n    if (server && (server.urls || server.url)) {\n      let urls = server.urls || server.url;\n      if (server.url && !server.urls) {\n        utils.deprecated('RTCIceServer.url', 'RTCIceServer.urls');\n      }\n      const isString = typeof urls === 'string';\n      if (isString) {\n        urls = [urls];\n      }\n      urls = urls.filter(url => {\n        // filter STUN unconditionally.\n        if (url.indexOf('stun:') === 0) {\n          return false;\n        }\n\n        const validTurn = url.startsWith('turn') &&\n            !url.startsWith('turn:[') &&\n            url.includes('transport=udp');\n        if (validTurn && !hasTurn) {\n          hasTurn = true;\n          return true;\n        }\n        return validTurn && !hasTurn;\n      });\n\n      delete server.url;\n      server.urls = isString ? urls[0] : urls;\n      return !!urls.length;\n    }\n  });\n}\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nimport * as utils from '../utils';\n\nexport function shimGetUserMedia(window, browserDetails) {\n  const navigator = window && window.navigator;\n  const MediaStreamTrack = window && window.MediaStreamTrack;\n\n  navigator.getUserMedia = function(constraints, onSuccess, onError) {\n    // Replace Firefox 44+'s deprecation warning with unprefixed version.\n    utils.deprecated('navigator.getUserMedia',\n        'navigator.mediaDevices.getUserMedia');\n    navigator.mediaDevices.getUserMedia(constraints).then(onSuccess, onError);\n  };\n\n  if (!(browserDetails.version > 55 &&\n      'autoGainControl' in navigator.mediaDevices.getSupportedConstraints())) {\n    const remap = function(obj, a, b) {\n      if (a in obj && !(b in obj)) {\n        obj[b] = obj[a];\n        delete obj[a];\n      }\n    };\n\n    const nativeGetUserMedia = navigator.mediaDevices.getUserMedia.\n        bind(navigator.mediaDevices);\n    navigator.mediaDevices.getUserMedia = function(c) {\n      if (typeof c === 'object' && typeof c.audio === 'object') {\n        c = JSON.parse(JSON.stringify(c));\n        remap(c.audio, 'autoGainControl', 'mozAutoGainControl');\n        remap(c.audio, 'noiseSuppression', 'mozNoiseSuppression');\n      }\n      return nativeGetUserMedia(c);\n    };\n\n    if (MediaStreamTrack && MediaStreamTrack.prototype.getSettings) {\n      const nativeGetSettings = MediaStreamTrack.prototype.getSettings;\n      MediaStreamTrack.prototype.getSettings = function() {\n        const obj = nativeGetSettings.apply(this, arguments);\n        remap(obj, 'mozAutoGainControl', 'autoGainControl');\n        remap(obj, 'mozNoiseSuppression', 'noiseSuppression');\n        return obj;\n      };\n    }\n\n    if (MediaStreamTrack && MediaStreamTrack.prototype.applyConstraints) {\n      const nativeApplyConstraints =\n        MediaStreamTrack.prototype.applyConstraints;\n      MediaStreamTrack.prototype.applyConstraints = function(c) {\n        if (this.kind === 'audio' && typeof c === 'object') {\n          c = JSON.parse(JSON.stringify(c));\n          remap(c, 'autoGainControl', 'mozAutoGainControl');\n          remap(c, 'noiseSuppression', 'mozNoiseSuppression');\n        }\n        return nativeApplyConstraints.apply(this, [c]);\n      };\n    }\n  }\n}\n","/*\n *  Copyright (c) 2018 The adapter.js project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nexport function shimGetDisplayMedia(window, preferredMediaSource) {\n  if (window.navigator.mediaDevices &&\n    'getDisplayMedia' in window.navigator.mediaDevices) {\n    return;\n  }\n  if (!(window.navigator.mediaDevices)) {\n    return;\n  }\n  window.navigator.mediaDevices.getDisplayMedia =\n    function getDisplayMedia(constraints) {\n      if (!(constraints && constraints.video)) {\n        const err = new DOMException('getDisplayMedia without video ' +\n            'constraints is undefined');\n        err.name = 'NotFoundError';\n        // from https://heycam.github.io/webidl/#idl-DOMException-error-names\n        err.code = 8;\n        return Promise.reject(err);\n      }\n      if (constraints.video === true) {\n        constraints.video = {mediaSource: preferredMediaSource};\n      } else {\n        constraints.video.mediaSource = preferredMediaSource;\n      }\n      return window.navigator.mediaDevices.getUserMedia(constraints);\n    };\n}\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nimport * as utils from '../utils';\nexport {shimGetUserMedia} from './getusermedia';\nexport {shimGetDisplayMedia} from './getdisplaymedia';\n\nexport function shimOnTrack(window) {\n  if (typeof window === 'object' && window.RTCTrackEvent &&\n      ('receiver' in window.RTCTrackEvent.prototype) &&\n      !('transceiver' in window.RTCTrackEvent.prototype)) {\n    Object.defineProperty(window.RTCTrackEvent.prototype, 'transceiver', {\n      get() {\n        return {receiver: this.receiver};\n      }\n    });\n  }\n}\n\nexport function shimPeerConnection(window, browserDetails) {\n  if (typeof window !== 'object' ||\n      !(window.RTCPeerConnection || window.mozRTCPeerConnection)) {\n    return; // probably media.peerconnection.enabled=false in about:config\n  }\n  if (!window.RTCPeerConnection && window.mozRTCPeerConnection) {\n    // very basic support for old versions.\n    window.RTCPeerConnection = window.mozRTCPeerConnection;\n  }\n\n  if (browserDetails.version < 53) {\n    // shim away need for obsolete RTCIceCandidate/RTCSessionDescription.\n    ['setLocalDescription', 'setRemoteDescription', 'addIceCandidate']\n        .forEach(function(method) {\n          const nativeMethod = window.RTCPeerConnection.prototype[method];\n          const methodObj = {[method]() {\n            arguments[0] = new ((method === 'addIceCandidate') ?\n                window.RTCIceCandidate :\n                window.RTCSessionDescription)(arguments[0]);\n            return nativeMethod.apply(this, arguments);\n          }};\n          window.RTCPeerConnection.prototype[method] = methodObj[method];\n        });\n  }\n\n  const modernStatsTypes = {\n    inboundrtp: 'inbound-rtp',\n    outboundrtp: 'outbound-rtp',\n    candidatepair: 'candidate-pair',\n    localcandidate: 'local-candidate',\n    remotecandidate: 'remote-candidate'\n  };\n\n  const nativeGetStats = window.RTCPeerConnection.prototype.getStats;\n  window.RTCPeerConnection.prototype.getStats = function getStats() {\n    const [selector, onSucc, onErr] = arguments;\n    return nativeGetStats.apply(this, [selector || null])\n      .then(stats => {\n        if (browserDetails.version < 53 && !onSucc) {\n          // Shim only promise getStats with spec-hyphens in type names\n          // Leave callback version alone; misc old uses of forEach before Map\n          try {\n            stats.forEach(stat => {\n              stat.type = modernStatsTypes[stat.type] || stat.type;\n            });\n          } catch (e) {\n            if (e.name !== 'TypeError') {\n              throw e;\n            }\n            // Avoid TypeError: \"type\" is read-only, in old versions. 34-43ish\n            stats.forEach((stat, i) => {\n              stats.set(i, Object.assign({}, stat, {\n                type: modernStatsTypes[stat.type] || stat.type\n              }));\n            });\n          }\n        }\n        return stats;\n      })\n      .then(onSucc, onErr);\n  };\n}\n\nexport function shimSenderGetStats(window) {\n  if (!(typeof window === 'object' && window.RTCPeerConnection &&\n      window.RTCRtpSender)) {\n    return;\n  }\n  if (window.RTCRtpSender && 'getStats' in window.RTCRtpSender.prototype) {\n    return;\n  }\n  const origGetSenders = window.RTCPeerConnection.prototype.getSenders;\n  if (origGetSenders) {\n    window.RTCPeerConnection.prototype.getSenders = function getSenders() {\n      const senders = origGetSenders.apply(this, []);\n      senders.forEach(sender => sender._pc = this);\n      return senders;\n    };\n  }\n\n  const origAddTrack = window.RTCPeerConnection.prototype.addTrack;\n  if (origAddTrack) {\n    window.RTCPeerConnection.prototype.addTrack = function addTrack() {\n      const sender = origAddTrack.apply(this, arguments);\n      sender._pc = this;\n      return sender;\n    };\n  }\n  window.RTCRtpSender.prototype.getStats = function getStats() {\n    return this.track ? this._pc.getStats(this.track) :\n        Promise.resolve(new Map());\n  };\n}\n\nexport function shimReceiverGetStats(window) {\n  if (!(typeof window === 'object' && window.RTCPeerConnection &&\n      window.RTCRtpSender)) {\n    return;\n  }\n  if (window.RTCRtpSender && 'getStats' in window.RTCRtpReceiver.prototype) {\n    return;\n  }\n  const origGetReceivers = window.RTCPeerConnection.prototype.getReceivers;\n  if (origGetReceivers) {\n    window.RTCPeerConnection.prototype.getReceivers = function getReceivers() {\n      const receivers = origGetReceivers.apply(this, []);\n      receivers.forEach(receiver => receiver._pc = this);\n      return receivers;\n    };\n  }\n  utils.wrapPeerConnectionEvent(window, 'track', e => {\n    e.receiver._pc = e.srcElement;\n    return e;\n  });\n  window.RTCRtpReceiver.prototype.getStats = function getStats() {\n    return this._pc.getStats(this.track);\n  };\n}\n\nexport function shimRemoveStream(window) {\n  if (!window.RTCPeerConnection ||\n      'removeStream' in window.RTCPeerConnection.prototype) {\n    return;\n  }\n  window.RTCPeerConnection.prototype.removeStream =\n    function removeStream(stream) {\n      utils.deprecated('removeStream', 'removeTrack');\n      this.getSenders().forEach(sender => {\n        if (sender.track && stream.getTracks().includes(sender.track)) {\n          this.removeTrack(sender);\n        }\n      });\n    };\n}\n\nexport function shimRTCDataChannel(window) {\n  // rename DataChannel to RTCDataChannel (native fix in FF60):\n  // https://bugzilla.mozilla.org/show_bug.cgi?id=1173851\n  if (window.DataChannel && !window.RTCDataChannel) {\n    window.RTCDataChannel = window.DataChannel;\n  }\n}\n\nexport function shimAddTransceiver(window) {\n  // https://github.com/webrtcHacks/adapter/issues/998#issuecomment-516921647\n  // Firefox ignores the init sendEncodings options passed to addTransceiver\n  // https://bugzilla.mozilla.org/show_bug.cgi?id=1396918\n  if (!(typeof window === 'object' && window.RTCPeerConnection)) {\n    return;\n  }\n  const origAddTransceiver = window.RTCPeerConnection.prototype.addTransceiver;\n  if (origAddTransceiver) {\n    window.RTCPeerConnection.prototype.addTransceiver =\n      function addTransceiver() {\n        this.setParametersPromises = [];\n        const initParameters = arguments[1];\n        const shouldPerformCheck = initParameters &&\n                                  'sendEncodings' in initParameters;\n        if (shouldPerformCheck) {\n          // If sendEncodings params are provided, validate grammar\n          initParameters.sendEncodings.forEach((encodingParam) => {\n            if ('rid' in encodingParam) {\n              const ridRegex = /^[a-z0-9]{0,16}$/i;\n              if (!ridRegex.test(encodingParam.rid)) {\n                throw new TypeError('Invalid RID value provided.');\n              }\n            }\n            if ('scaleResolutionDownBy' in encodingParam) {\n              if (!(parseFloat(encodingParam.scaleResolutionDownBy) >= 1.0)) {\n                throw new RangeError('scale_resolution_down_by must be >= 1.0');\n              }\n            }\n            if ('maxFramerate' in encodingParam) {\n              if (!(parseFloat(encodingParam.maxFramerate) >= 0)) {\n                throw new RangeError('max_framerate must be >= 0.0');\n              }\n            }\n          });\n        }\n        const transceiver = origAddTransceiver.apply(this, arguments);\n        if (shouldPerformCheck) {\n          // Check if the init options were applied. If not we do this in an\n          // asynchronous way and save the promise reference in a global object.\n          // This is an ugly hack, but at the same time is way more robust than\n          // checking the sender parameters before and after the createOffer\n          // Also note that after the createoffer we are not 100% sure that\n          // the params were asynchronously applied so we might miss the\n          // opportunity to recreate offer.\n          const {sender} = transceiver;\n          const params = sender.getParameters();\n          if (!('encodings' in params) ||\n              // Avoid being fooled by patched getParameters() below.\n              (params.encodings.length === 1 &&\n               Object.keys(params.encodings[0]).length === 0)) {\n            params.encodings = initParameters.sendEncodings;\n            sender.sendEncodings = initParameters.sendEncodings;\n            this.setParametersPromises.push(sender.setParameters(params)\n              .then(() => {\n                delete sender.sendEncodings;\n              }).catch(() => {\n                delete sender.sendEncodings;\n              })\n            );\n          }\n        }\n        return transceiver;\n      };\n  }\n}\n\nexport function shimGetParameters(window) {\n  if (!(typeof window === 'object' && window.RTCRtpSender)) {\n    return;\n  }\n  const origGetParameters = window.RTCRtpSender.prototype.getParameters;\n  if (origGetParameters) {\n    window.RTCRtpSender.prototype.getParameters =\n      function getParameters() {\n        const params = origGetParameters.apply(this, arguments);\n        if (!('encodings' in params)) {\n          params.encodings = [].concat(this.sendEncodings || [{}]);\n        }\n        return params;\n      };\n  }\n}\n\nexport function shimCreateOffer(window) {\n  // https://github.com/webrtcHacks/adapter/issues/998#issuecomment-516921647\n  // Firefox ignores the init sendEncodings options passed to addTransceiver\n  // https://bugzilla.mozilla.org/show_bug.cgi?id=1396918\n  if (!(typeof window === 'object' && window.RTCPeerConnection)) {\n    return;\n  }\n  const origCreateOffer = window.RTCPeerConnection.prototype.createOffer;\n  window.RTCPeerConnection.prototype.createOffer = function createOffer() {\n    if (this.setParametersPromises && this.setParametersPromises.length) {\n      return Promise.all(this.setParametersPromises)\n      .then(() => {\n        return origCreateOffer.apply(this, arguments);\n      })\n      .finally(() => {\n        this.setParametersPromises = [];\n      });\n    }\n    return origCreateOffer.apply(this, arguments);\n  };\n}\n\nexport function shimCreateAnswer(window) {\n  // https://github.com/webrtcHacks/adapter/issues/998#issuecomment-516921647\n  // Firefox ignores the init sendEncodings options passed to addTransceiver\n  // https://bugzilla.mozilla.org/show_bug.cgi?id=1396918\n  if (!(typeof window === 'object' && window.RTCPeerConnection)) {\n    return;\n  }\n  const origCreateAnswer = window.RTCPeerConnection.prototype.createAnswer;\n  window.RTCPeerConnection.prototype.createAnswer = function createAnswer() {\n    if (this.setParametersPromises && this.setParametersPromises.length) {\n      return Promise.all(this.setParametersPromises)\n      .then(() => {\n        return origCreateAnswer.apply(this, arguments);\n      })\n      .finally(() => {\n        this.setParametersPromises = [];\n      });\n    }\n    return origCreateAnswer.apply(this, arguments);\n  };\n}\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n'use strict';\nimport * as utils from '../utils';\n\nexport function shimLocalStreamsAPI(window) {\n  if (typeof window !== 'object' || !window.RTCPeerConnection) {\n    return;\n  }\n  if (!('getLocalStreams' in window.RTCPeerConnection.prototype)) {\n    window.RTCPeerConnection.prototype.getLocalStreams =\n      function getLocalStreams() {\n        if (!this._localStreams) {\n          this._localStreams = [];\n        }\n        return this._localStreams;\n      };\n  }\n  if (!('addStream' in window.RTCPeerConnection.prototype)) {\n    const _addTrack = window.RTCPeerConnection.prototype.addTrack;\n    window.RTCPeerConnection.prototype.addStream = function addStream(stream) {\n      if (!this._localStreams) {\n        this._localStreams = [];\n      }\n      if (!this._localStreams.includes(stream)) {\n        this._localStreams.push(stream);\n      }\n      // Try to emulate Chrome's behaviour of adding in audio-video order.\n      // Safari orders by track id.\n      stream.getAudioTracks().forEach(track => _addTrack.call(this, track,\n        stream));\n      stream.getVideoTracks().forEach(track => _addTrack.call(this, track,\n        stream));\n    };\n\n    window.RTCPeerConnection.prototype.addTrack =\n      function addTrack(track, ...streams) {\n        if (streams) {\n          streams.forEach((stream) => {\n            if (!this._localStreams) {\n              this._localStreams = [stream];\n            } else if (!this._localStreams.includes(stream)) {\n              this._localStreams.push(stream);\n            }\n          });\n        }\n        return _addTrack.apply(this, arguments);\n      };\n  }\n  if (!('removeStream' in window.RTCPeerConnection.prototype)) {\n    window.RTCPeerConnection.prototype.removeStream =\n      function removeStream(stream) {\n        if (!this._localStreams) {\n          this._localStreams = [];\n        }\n        const index = this._localStreams.indexOf(stream);\n        if (index === -1) {\n          return;\n        }\n        this._localStreams.splice(index, 1);\n        const tracks = stream.getTracks();\n        this.getSenders().forEach(sender => {\n          if (tracks.includes(sender.track)) {\n            this.removeTrack(sender);\n          }\n        });\n      };\n  }\n}\n\nexport function shimRemoteStreamsAPI(window) {\n  if (typeof window !== 'object' || !window.RTCPeerConnection) {\n    return;\n  }\n  if (!('getRemoteStreams' in window.RTCPeerConnection.prototype)) {\n    window.RTCPeerConnection.prototype.getRemoteStreams =\n      function getRemoteStreams() {\n        return this._remoteStreams ? this._remoteStreams : [];\n      };\n  }\n  if (!('onaddstream' in window.RTCPeerConnection.prototype)) {\n    Object.defineProperty(window.RTCPeerConnection.prototype, 'onaddstream', {\n      get() {\n        return this._onaddstream;\n      },\n      set(f) {\n        if (this._onaddstream) {\n          this.removeEventListener('addstream', this._onaddstream);\n          this.removeEventListener('track', this._onaddstreampoly);\n        }\n        this.addEventListener('addstream', this._onaddstream = f);\n        this.addEventListener('track', this._onaddstreampoly = (e) => {\n          e.streams.forEach(stream => {\n            if (!this._remoteStreams) {\n              this._remoteStreams = [];\n            }\n            if (this._remoteStreams.includes(stream)) {\n              return;\n            }\n            this._remoteStreams.push(stream);\n            const event = new Event('addstream');\n            event.stream = stream;\n            this.dispatchEvent(event);\n          });\n        });\n      }\n    });\n    const origSetRemoteDescription =\n      window.RTCPeerConnection.prototype.setRemoteDescription;\n    window.RTCPeerConnection.prototype.setRemoteDescription =\n      function setRemoteDescription() {\n        const pc = this;\n        if (!this._onaddstreampoly) {\n          this.addEventListener('track', this._onaddstreampoly = function(e) {\n            e.streams.forEach(stream => {\n              if (!pc._remoteStreams) {\n                pc._remoteStreams = [];\n              }\n              if (pc._remoteStreams.indexOf(stream) >= 0) {\n                return;\n              }\n              pc._remoteStreams.push(stream);\n              const event = new Event('addstream');\n              event.stream = stream;\n              pc.dispatchEvent(event);\n            });\n          });\n        }\n        return origSetRemoteDescription.apply(pc, arguments);\n      };\n  }\n}\n\nexport function shimCallbacksAPI(window) {\n  if (typeof window !== 'object' || !window.RTCPeerConnection) {\n    return;\n  }\n  const prototype = window.RTCPeerConnection.prototype;\n  const origCreateOffer = prototype.createOffer;\n  const origCreateAnswer = prototype.createAnswer;\n  const setLocalDescription = prototype.setLocalDescription;\n  const setRemoteDescription = prototype.setRemoteDescription;\n  const addIceCandidate = prototype.addIceCandidate;\n\n  prototype.createOffer =\n    function createOffer(successCallback, failureCallback) {\n      const options = (arguments.length >= 2) ? arguments[2] : arguments[0];\n      const promise = origCreateOffer.apply(this, [options]);\n      if (!failureCallback) {\n        return promise;\n      }\n      promise.then(successCallback, failureCallback);\n      return Promise.resolve();\n    };\n\n  prototype.createAnswer =\n    function createAnswer(successCallback, failureCallback) {\n      const options = (arguments.length >= 2) ? arguments[2] : arguments[0];\n      const promise = origCreateAnswer.apply(this, [options]);\n      if (!failureCallback) {\n        return promise;\n      }\n      promise.then(successCallback, failureCallback);\n      return Promise.resolve();\n    };\n\n  let withCallback = function(description, successCallback, failureCallback) {\n    const promise = setLocalDescription.apply(this, [description]);\n    if (!failureCallback) {\n      return promise;\n    }\n    promise.then(successCallback, failureCallback);\n    return Promise.resolve();\n  };\n  prototype.setLocalDescription = withCallback;\n\n  withCallback = function(description, successCallback, failureCallback) {\n    const promise = setRemoteDescription.apply(this, [description]);\n    if (!failureCallback) {\n      return promise;\n    }\n    promise.then(successCallback, failureCallback);\n    return Promise.resolve();\n  };\n  prototype.setRemoteDescription = withCallback;\n\n  withCallback = function(candidate, successCallback, failureCallback) {\n    const promise = addIceCandidate.apply(this, [candidate]);\n    if (!failureCallback) {\n      return promise;\n    }\n    promise.then(successCallback, failureCallback);\n    return Promise.resolve();\n  };\n  prototype.addIceCandidate = withCallback;\n}\n\nexport function shimGetUserMedia(window) {\n  const navigator = window && window.navigator;\n\n  if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {\n    // shim not needed in Safari 12.1\n    const mediaDevices = navigator.mediaDevices;\n    const _getUserMedia = mediaDevices.getUserMedia.bind(mediaDevices);\n    navigator.mediaDevices.getUserMedia = (constraints) => {\n      return _getUserMedia(shimConstraints(constraints));\n    };\n  }\n\n  if (!navigator.getUserMedia && navigator.mediaDevices &&\n    navigator.mediaDevices.getUserMedia) {\n    navigator.getUserMedia = function getUserMedia(constraints, cb, errcb) {\n      navigator.mediaDevices.getUserMedia(constraints)\n      .then(cb, errcb);\n    }.bind(navigator);\n  }\n}\n\nexport function shimConstraints(constraints) {\n  if (constraints && constraints.video !== undefined) {\n    return Object.assign({},\n      constraints,\n      {video: utils.compactObject(constraints.video)}\n    );\n  }\n\n  return constraints;\n}\n\nexport function shimRTCIceServerUrls(window) {\n  if (!window.RTCPeerConnection) {\n    return;\n  }\n  // migrate from non-spec RTCIceServer.url to RTCIceServer.urls\n  const OrigPeerConnection = window.RTCPeerConnection;\n  window.RTCPeerConnection =\n    function RTCPeerConnection(pcConfig, pcConstraints) {\n      if (pcConfig && pcConfig.iceServers) {\n        const newIceServers = [];\n        for (let i = 0; i < pcConfig.iceServers.length; i++) {\n          let server = pcConfig.iceServers[i];\n          if (!server.hasOwnProperty('urls') &&\n              server.hasOwnProperty('url')) {\n            utils.deprecated('RTCIceServer.url', 'RTCIceServer.urls');\n            server = JSON.parse(JSON.stringify(server));\n            server.urls = server.url;\n            delete server.url;\n            newIceServers.push(server);\n          } else {\n            newIceServers.push(pcConfig.iceServers[i]);\n          }\n        }\n        pcConfig.iceServers = newIceServers;\n      }\n      return new OrigPeerConnection(pcConfig, pcConstraints);\n    };\n  window.RTCPeerConnection.prototype = OrigPeerConnection.prototype;\n  // wrap static methods. Currently just generateCertificate.\n  if ('generateCertificate' in OrigPeerConnection) {\n    Object.defineProperty(window.RTCPeerConnection, 'generateCertificate', {\n      get() {\n        return OrigPeerConnection.generateCertificate;\n      }\n    });\n  }\n}\n\nexport function shimTrackEventTransceiver(window) {\n  // Add event.transceiver member over deprecated event.receiver\n  if (typeof window === 'object' && window.RTCTrackEvent &&\n      'receiver' in window.RTCTrackEvent.prototype &&\n      !('transceiver' in window.RTCTrackEvent.prototype)) {\n    Object.defineProperty(window.RTCTrackEvent.prototype, 'transceiver', {\n      get() {\n        return {receiver: this.receiver};\n      }\n    });\n  }\n}\n\nexport function shimCreateOfferLegacy(window) {\n  const origCreateOffer = window.RTCPeerConnection.prototype.createOffer;\n  window.RTCPeerConnection.prototype.createOffer =\n    function createOffer(offerOptions) {\n      if (offerOptions) {\n        if (typeof offerOptions.offerToReceiveAudio !== 'undefined') {\n          // support bit values\n          offerOptions.offerToReceiveAudio =\n            !!offerOptions.offerToReceiveAudio;\n        }\n        const audioTransceiver = this.getTransceivers().find(transceiver =>\n          transceiver.receiver.track.kind === 'audio');\n        if (offerOptions.offerToReceiveAudio === false && audioTransceiver) {\n          if (audioTransceiver.direction === 'sendrecv') {\n            if (audioTransceiver.setDirection) {\n              audioTransceiver.setDirection('sendonly');\n            } else {\n              audioTransceiver.direction = 'sendonly';\n            }\n          } else if (audioTransceiver.direction === 'recvonly') {\n            if (audioTransceiver.setDirection) {\n              audioTransceiver.setDirection('inactive');\n            } else {\n              audioTransceiver.direction = 'inactive';\n            }\n          }\n        } else if (offerOptions.offerToReceiveAudio === true &&\n            !audioTransceiver) {\n          this.addTransceiver('audio');\n        }\n\n        if (typeof offerOptions.offerToReceiveVideo !== 'undefined') {\n          // support bit values\n          offerOptions.offerToReceiveVideo =\n            !!offerOptions.offerToReceiveVideo;\n        }\n        const videoTransceiver = this.getTransceivers().find(transceiver =>\n          transceiver.receiver.track.kind === 'video');\n        if (offerOptions.offerToReceiveVideo === false && videoTransceiver) {\n          if (videoTransceiver.direction === 'sendrecv') {\n            if (videoTransceiver.setDirection) {\n              videoTransceiver.setDirection('sendonly');\n            } else {\n              videoTransceiver.direction = 'sendonly';\n            }\n          } else if (videoTransceiver.direction === 'recvonly') {\n            if (videoTransceiver.setDirection) {\n              videoTransceiver.setDirection('inactive');\n            } else {\n              videoTransceiver.direction = 'inactive';\n            }\n          }\n        } else if (offerOptions.offerToReceiveVideo === true &&\n            !videoTransceiver) {\n          this.addTransceiver('video');\n        }\n      }\n      return origCreateOffer.apply(this, arguments);\n    };\n}\n\nexport function shimAudioContext(window) {\n  if (typeof window !== 'object' || window.AudioContext) {\n    return;\n  }\n  window.AudioContext = window.webkitAudioContext;\n}\n","/*\n *  Copyright (c) 2017 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nimport SDPUtils from 'sdp';\nimport * as utils from './utils';\n\nexport function shimRTCIceCandidate(window) {\n  // foundation is arbitrarily chosen as an indicator for full support for\n  // https://w3c.github.io/webrtc-pc/#rtcicecandidate-interface\n  if (!window.RTCIceCandidate || (window.RTCIceCandidate && 'foundation' in\n      window.RTCIceCandidate.prototype)) {\n    return;\n  }\n\n  const NativeRTCIceCandidate = window.RTCIceCandidate;\n  window.RTCIceCandidate = function RTCIceCandidate(args) {\n    // Remove the a= which shouldn't be part of the candidate string.\n    if (typeof args === 'object' && args.candidate &&\n        args.candidate.indexOf('a=') === 0) {\n      args = JSON.parse(JSON.stringify(args));\n      args.candidate = args.candidate.substr(2);\n    }\n\n    if (args.candidate && args.candidate.length) {\n      // Augment the native candidate with the parsed fields.\n      const nativeCandidate = new NativeRTCIceCandidate(args);\n      const parsedCandidate = SDPUtils.parseCandidate(args.candidate);\n      const augmentedCandidate = Object.assign(nativeCandidate,\n          parsedCandidate);\n\n      // Add a serializer that does not serialize the extra attributes.\n      augmentedCandidate.toJSON = function toJSON() {\n        return {\n          candidate: augmentedCandidate.candidate,\n          sdpMid: augmentedCandidate.sdpMid,\n          sdpMLineIndex: augmentedCandidate.sdpMLineIndex,\n          usernameFragment: augmentedCandidate.usernameFragment,\n        };\n      };\n      return augmentedCandidate;\n    }\n    return new NativeRTCIceCandidate(args);\n  };\n  window.RTCIceCandidate.prototype = NativeRTCIceCandidate.prototype;\n\n  // Hook up the augmented candidate in onicecandidate and\n  // addEventListener('icecandidate', ...)\n  utils.wrapPeerConnectionEvent(window, 'icecandidate', e => {\n    if (e.candidate) {\n      Object.defineProperty(e, 'candidate', {\n        value: new window.RTCIceCandidate(e.candidate),\n        writable: 'false'\n      });\n    }\n    return e;\n  });\n}\n\nexport function shimMaxMessageSize(window, browserDetails) {\n  if (!window.RTCPeerConnection) {\n    return;\n  }\n\n  if (!('sctp' in window.RTCPeerConnection.prototype)) {\n    Object.defineProperty(window.RTCPeerConnection.prototype, 'sctp', {\n      get() {\n        return typeof this._sctp === 'undefined' ? null : this._sctp;\n      }\n    });\n  }\n\n  const sctpInDescription = function(description) {\n    if (!description || !description.sdp) {\n      return false;\n    }\n    const sections = SDPUtils.splitSections(description.sdp);\n    sections.shift();\n    return sections.some(mediaSection => {\n      const mLine = SDPUtils.parseMLine(mediaSection);\n      return mLine && mLine.kind === 'application'\n          && mLine.protocol.indexOf('SCTP') !== -1;\n    });\n  };\n\n  const getRemoteFirefoxVersion = function(description) {\n    // TODO: Is there a better solution for detecting Firefox?\n    const match = description.sdp.match(/mozilla...THIS_IS_SDPARTA-(\\d+)/);\n    if (match === null || match.length < 2) {\n      return -1;\n    }\n    const version = parseInt(match[1], 10);\n    // Test for NaN (yes, this is ugly)\n    return version !== version ? -1 : version;\n  };\n\n  const getCanSendMaxMessageSize = function(remoteIsFirefox) {\n    // Every implementation we know can send at least 64 KiB.\n    // Note: Although Chrome is technically able to send up to 256 KiB, the\n    //       data does not reach the other peer reliably.\n    //       See: https://bugs.chromium.org/p/webrtc/issues/detail?id=8419\n    let canSendMaxMessageSize = 65536;\n    if (browserDetails.browser === 'firefox') {\n      if (browserDetails.version < 57) {\n        if (remoteIsFirefox === -1) {\n          // FF < 57 will send in 16 KiB chunks using the deprecated PPID\n          // fragmentation.\n          canSendMaxMessageSize = 16384;\n        } else {\n          // However, other FF (and RAWRTC) can reassemble PPID-fragmented\n          // messages. Thus, supporting ~2 GiB when sending.\n          canSendMaxMessageSize = 2147483637;\n        }\n      } else if (browserDetails.version < 60) {\n        // Currently, all FF >= 57 will reset the remote maximum message size\n        // to the default value when a data channel is created at a later\n        // stage. :(\n        // See: https://bugzilla.mozilla.org/show_bug.cgi?id=1426831\n        canSendMaxMessageSize =\n          browserDetails.version === 57 ? 65535 : 65536;\n      } else {\n        // FF >= 60 supports sending ~2 GiB\n        canSendMaxMessageSize = 2147483637;\n      }\n    }\n    return canSendMaxMessageSize;\n  };\n\n  const getMaxMessageSize = function(description, remoteIsFirefox) {\n    // Note: 65536 bytes is the default value from the SDP spec. Also,\n    //       every implementation we know supports receiving 65536 bytes.\n    let maxMessageSize = 65536;\n\n    // FF 57 has a slightly incorrect default remote max message size, so\n    // we need to adjust it here to avoid a failure when sending.\n    // See: https://bugzilla.mozilla.org/show_bug.cgi?id=1425697\n    if (browserDetails.browser === 'firefox'\n         && browserDetails.version === 57) {\n      maxMessageSize = 65535;\n    }\n\n    const match = SDPUtils.matchPrefix(description.sdp,\n      'a=max-message-size:');\n    if (match.length > 0) {\n      maxMessageSize = parseInt(match[0].substr(19), 10);\n    } else if (browserDetails.browser === 'firefox' &&\n                remoteIsFirefox !== -1) {\n      // If the maximum message size is not present in the remote SDP and\n      // both local and remote are Firefox, the remote peer can receive\n      // ~2 GiB.\n      maxMessageSize = 2147483637;\n    }\n    return maxMessageSize;\n  };\n\n  const origSetRemoteDescription =\n      window.RTCPeerConnection.prototype.setRemoteDescription;\n  window.RTCPeerConnection.prototype.setRemoteDescription =\n    function setRemoteDescription() {\n      this._sctp = null;\n      // Chrome decided to not expose .sctp in plan-b mode.\n      // As usual, adapter.js has to do an 'ugly worakaround'\n      // to cover up the mess.\n      if (browserDetails.browser === 'chrome' && browserDetails.version >= 76) {\n        const {sdpSemantics} = this.getConfiguration();\n        if (sdpSemantics === 'plan-b') {\n          Object.defineProperty(this, 'sctp', {\n            get() {\n              return typeof this._sctp === 'undefined' ? null : this._sctp;\n            },\n            enumerable: true,\n            configurable: true,\n          });\n        }\n      }\n\n      if (sctpInDescription(arguments[0])) {\n        // Check if the remote is FF.\n        const isFirefox = getRemoteFirefoxVersion(arguments[0]);\n\n        // Get the maximum message size the local peer is capable of sending\n        const canSendMMS = getCanSendMaxMessageSize(isFirefox);\n\n        // Get the maximum message size of the remote peer.\n        const remoteMMS = getMaxMessageSize(arguments[0], isFirefox);\n\n        // Determine final maximum message size\n        let maxMessageSize;\n        if (canSendMMS === 0 && remoteMMS === 0) {\n          maxMessageSize = Number.POSITIVE_INFINITY;\n        } else if (canSendMMS === 0 || remoteMMS === 0) {\n          maxMessageSize = Math.max(canSendMMS, remoteMMS);\n        } else {\n          maxMessageSize = Math.min(canSendMMS, remoteMMS);\n        }\n\n        // Create a dummy RTCSctpTransport object and the 'maxMessageSize'\n        // attribute.\n        const sctp = {};\n        Object.defineProperty(sctp, 'maxMessageSize', {\n          get() {\n            return maxMessageSize;\n          }\n        });\n        this._sctp = sctp;\n      }\n\n      return origSetRemoteDescription.apply(this, arguments);\n    };\n}\n\nexport function shimSendThrowTypeError(window) {\n  if (!(window.RTCPeerConnection &&\n      'createDataChannel' in window.RTCPeerConnection.prototype)) {\n    return;\n  }\n\n  // Note: Although Firefox >= 57 has a native implementation, the maximum\n  //       message size can be reset for all data channels at a later stage.\n  //       See: https://bugzilla.mozilla.org/show_bug.cgi?id=1426831\n\n  function wrapDcSend(dc, pc) {\n    const origDataChannelSend = dc.send;\n    dc.send = function send() {\n      const data = arguments[0];\n      const length = data.length || data.size || data.byteLength;\n      if (dc.readyState === 'open' &&\n          pc.sctp && length > pc.sctp.maxMessageSize) {\n        throw new TypeError('Message too large (can send a maximum of ' +\n          pc.sctp.maxMessageSize + ' bytes)');\n      }\n      return origDataChannelSend.apply(dc, arguments);\n    };\n  }\n  const origCreateDataChannel =\n    window.RTCPeerConnection.prototype.createDataChannel;\n  window.RTCPeerConnection.prototype.createDataChannel =\n    function createDataChannel() {\n      const dataChannel = origCreateDataChannel.apply(this, arguments);\n      wrapDcSend(dataChannel, this);\n      return dataChannel;\n    };\n  utils.wrapPeerConnectionEvent(window, 'datachannel', e => {\n    wrapDcSend(e.channel, e.target);\n    return e;\n  });\n}\n\n\n/* shims RTCConnectionState by pretending it is the same as iceConnectionState.\n * See https://bugs.chromium.org/p/webrtc/issues/detail?id=6145#c12\n * for why this is a valid hack in Chrome. In Firefox it is slightly incorrect\n * since DTLS failures would be hidden. See\n * https://bugzilla.mozilla.org/show_bug.cgi?id=1265827\n * for the Firefox tracking bug.\n */\nexport function shimConnectionState(window) {\n  if (!window.RTCPeerConnection ||\n      'connectionState' in window.RTCPeerConnection.prototype) {\n    return;\n  }\n  const proto = window.RTCPeerConnection.prototype;\n  Object.defineProperty(proto, 'connectionState', {\n    get() {\n      return {\n        completed: 'connected',\n        checking: 'connecting'\n      }[this.iceConnectionState] || this.iceConnectionState;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(proto, 'onconnectionstatechange', {\n    get() {\n      return this._onconnectionstatechange || null;\n    },\n    set(cb) {\n      if (this._onconnectionstatechange) {\n        this.removeEventListener('connectionstatechange',\n            this._onconnectionstatechange);\n        delete this._onconnectionstatechange;\n      }\n      if (cb) {\n        this.addEventListener('connectionstatechange',\n            this._onconnectionstatechange = cb);\n      }\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  ['setLocalDescription', 'setRemoteDescription'].forEach((method) => {\n    const origMethod = proto[method];\n    proto[method] = function() {\n      if (!this._connectionstatechangepoly) {\n        this._connectionstatechangepoly = e => {\n          const pc = e.target;\n          if (pc._lastConnectionState !== pc.connectionState) {\n            pc._lastConnectionState = pc.connectionState;\n            const newEvent = new Event('connectionstatechange', e);\n            pc.dispatchEvent(newEvent);\n          }\n          return e;\n        };\n        this.addEventListener('iceconnectionstatechange',\n          this._connectionstatechangepoly);\n      }\n      return origMethod.apply(this, arguments);\n    };\n  });\n}\n\nexport function removeExtmapAllowMixed(window, browserDetails) {\n  /* remove a=extmap-allow-mixed for webrtc.org < M71 */\n  if (!window.RTCPeerConnection) {\n    return;\n  }\n  if (browserDetails.browser === 'chrome' && browserDetails.version >= 71) {\n    return;\n  }\n  if (browserDetails.browser === 'safari' && browserDetails.version >= 605) {\n    return;\n  }\n  const nativeSRD = window.RTCPeerConnection.prototype.setRemoteDescription;\n  window.RTCPeerConnection.prototype.setRemoteDescription =\n  function setRemoteDescription(desc) {\n    if (desc && desc.sdp && desc.sdp.indexOf('\\na=extmap-allow-mixed') !== -1) {\n      const sdp = desc.sdp.split('\\n').filter((line) => {\n        return line.trim() !== 'a=extmap-allow-mixed';\n      }).join('\\n');\n      // Safari enforces read-only-ness of RTCSessionDescription fields.\n      if (window.RTCSessionDescription &&\n          desc instanceof window.RTCSessionDescription) {\n        arguments[0] = new window.RTCSessionDescription({\n          type: desc.type,\n          sdp,\n        });\n      } else {\n        desc.sdp = sdp;\n      }\n    }\n    return nativeSRD.apply(this, arguments);\n  };\n}\n\nexport function shimAddIceCandidateNullOrEmpty(window, browserDetails) {\n  // Support for addIceCandidate(null or undefined)\n  // as well as addIceCandidate({candidate: \"\", ...})\n  // https://bugs.chromium.org/p/chromium/issues/detail?id=978582\n  // Note: must be called before other polyfills which change the signature.\n  if (!(window.RTCPeerConnection && window.RTCPeerConnection.prototype)) {\n    return;\n  }\n  const nativeAddIceCandidate =\n      window.RTCPeerConnection.prototype.addIceCandidate;\n  if (!nativeAddIceCandidate || nativeAddIceCandidate.length === 0) {\n    return;\n  }\n  window.RTCPeerConnection.prototype.addIceCandidate =\n    function addIceCandidate() {\n      if (!arguments[0]) {\n        if (arguments[1]) {\n          arguments[1].apply(null);\n        }\n        return Promise.resolve();\n      }\n      // Firefox 68+ emits and processes {candidate: \"\", ...}, ignore\n      // in older versions.\n      // Native support for ignoring exists for Chrome M77+.\n      // Safari ignores as well, exact version unknown but works in the same\n      // version that also ignores addIceCandidate(null).\n      if (((browserDetails.browser === 'chrome' && browserDetails.version < 78)\n           || (browserDetails.browser === 'firefox'\n               && browserDetails.version < 68)\n           || (browserDetails.browser === 'safari'))\n          && arguments[0] && arguments[0].candidate === '') {\n        return Promise.resolve();\n      }\n      return nativeAddIceCandidate.apply(this, arguments);\n    };\n}\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n\n'use strict';\n\nimport {adapterFactory} from './adapter_factory.js';\n\nconst adapter =\n  adapterFactory({window: typeof window === 'undefined' ? undefined : window});\nexport default adapter;\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\nimport * as utils from './utils';\n\n  // Browser shims.\nimport * as chromeShim from './chrome/chrome_shim';\nimport * as edgeShim from './edge/edge_shim';\nimport * as firefoxShim from './firefox/firefox_shim';\nimport * as safariShim from './safari/safari_shim';\nimport * as commonShim from './common_shim';\n\n// Shimming starts here.\nexport function adapterFactory({window} = {}, options = {\n  shimChrome: true,\n  shimFirefox: true,\n  shimEdge: true,\n  shimSafari: true,\n}) {\n  // Utils.\n  const logging = utils.log;\n  const browserDetails = utils.detectBrowser(window);\n\n  const adapter = {\n    browserDetails,\n    commonShim,\n    extractVersion: utils.extractVersion,\n    disableLog: utils.disableLog,\n    disableWarnings: utils.disableWarnings\n  };\n\n  // Shim browser if found.\n  switch (browserDetails.browser) {\n    case 'chrome':\n      if (!chromeShim || !chromeShim.shimPeerConnection ||\n          !options.shimChrome) {\n        logging('Chrome shim is not included in this adapter release.');\n        return adapter;\n      }\n      if (browserDetails.version === null) {\n        logging('Chrome shim can not determine version, not shimming.');\n        return adapter;\n      }\n      logging('adapter.js shimming chrome.');\n      // Export to the adapter global object visible in the browser.\n      adapter.browserShim = chromeShim;\n\n      // Must be called before shimPeerConnection.\n      commonShim.shimAddIceCandidateNullOrEmpty(window, browserDetails);\n\n      chromeShim.shimGetUserMedia(window, browserDetails);\n      chromeShim.shimMediaStream(window, browserDetails);\n      chromeShim.shimPeerConnection(window, browserDetails);\n      chromeShim.shimOnTrack(window, browserDetails);\n      chromeShim.shimAddTrackRemoveTrack(window, browserDetails);\n      chromeShim.shimGetSendersWithDtmf(window, browserDetails);\n      chromeShim.shimGetStats(window, browserDetails);\n      chromeShim.shimSenderReceiverGetStats(window, browserDetails);\n      chromeShim.fixNegotiationNeeded(window, browserDetails);\n\n      commonShim.shimRTCIceCandidate(window, browserDetails);\n      commonShim.shimConnectionState(window, browserDetails);\n      commonShim.shimMaxMessageSize(window, browserDetails);\n      commonShim.shimSendThrowTypeError(window, browserDetails);\n      commonShim.removeExtmapAllowMixed(window, browserDetails);\n      break;\n    case 'firefox':\n      if (!firefoxShim || !firefoxShim.shimPeerConnection ||\n          !options.shimFirefox) {\n        logging('Firefox shim is not included in this adapter release.');\n        return adapter;\n      }\n      logging('adapter.js shimming firefox.');\n      // Export to the adapter global object visible in the browser.\n      adapter.browserShim = firefoxShim;\n\n      // Must be called before shimPeerConnection.\n      commonShim.shimAddIceCandidateNullOrEmpty(window, browserDetails);\n\n      firefoxShim.shimGetUserMedia(window, browserDetails);\n      firefoxShim.shimPeerConnection(window, browserDetails);\n      firefoxShim.shimOnTrack(window, browserDetails);\n      firefoxShim.shimRemoveStream(window, browserDetails);\n      firefoxShim.shimSenderGetStats(window, browserDetails);\n      firefoxShim.shimReceiverGetStats(window, browserDetails);\n      firefoxShim.shimRTCDataChannel(window, browserDetails);\n      firefoxShim.shimAddTransceiver(window, browserDetails);\n      firefoxShim.shimGetParameters(window, browserDetails);\n      firefoxShim.shimCreateOffer(window, browserDetails);\n      firefoxShim.shimCreateAnswer(window, browserDetails);\n\n      commonShim.shimRTCIceCandidate(window, browserDetails);\n      commonShim.shimConnectionState(window, browserDetails);\n      commonShim.shimMaxMessageSize(window, browserDetails);\n      commonShim.shimSendThrowTypeError(window, browserDetails);\n      break;\n    case 'edge':\n      if (!edgeShim || !edgeShim.shimPeerConnection || !options.shimEdge) {\n        logging('MS edge shim is not included in this adapter release.');\n        return adapter;\n      }\n      logging('adapter.js shimming edge.');\n      // Export to the adapter global object visible in the browser.\n      adapter.browserShim = edgeShim;\n\n      edgeShim.shimGetUserMedia(window, browserDetails);\n      edgeShim.shimGetDisplayMedia(window, browserDetails);\n      edgeShim.shimPeerConnection(window, browserDetails);\n      edgeShim.shimReplaceTrack(window, browserDetails);\n\n      // the edge shim implements the full RTCIceCandidate object.\n\n      commonShim.shimMaxMessageSize(window, browserDetails);\n      commonShim.shimSendThrowTypeError(window, browserDetails);\n      break;\n    case 'safari':\n      if (!safariShim || !options.shimSafari) {\n        logging('Safari shim is not included in this adapter release.');\n        return adapter;\n      }\n      logging('adapter.js shimming safari.');\n      // Export to the adapter global object visible in the browser.\n      adapter.browserShim = safariShim;\n\n      // Must be called before shimCallbackAPI.\n      commonShim.shimAddIceCandidateNullOrEmpty(window, browserDetails);\n\n      safariShim.shimRTCIceServerUrls(window, browserDetails);\n      safariShim.shimCreateOfferLegacy(window, browserDetails);\n      safariShim.shimCallbacksAPI(window, browserDetails);\n      safariShim.shimLocalStreamsAPI(window, browserDetails);\n      safariShim.shimRemoteStreamsAPI(window, browserDetails);\n      safariShim.shimTrackEventTransceiver(window, browserDetails);\n      safariShim.shimGetUserMedia(window, browserDetails);\n      safariShim.shimAudioContext(window, browserDetails);\n\n      commonShim.shimRTCIceCandidate(window, browserDetails);\n      commonShim.shimMaxMessageSize(window, browserDetails);\n      commonShim.shimSendThrowTypeError(window, browserDetails);\n      commonShim.removeExtmapAllowMixed(window, browserDetails);\n      break;\n    default:\n      logging('Unsupported browser!');\n      break;\n  }\n\n  return adapter;\n}\n"],"sourceRoot":""}